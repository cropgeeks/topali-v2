// (C) 2003-2007 Biomathematics & Statistics Scotland
//
// This package may be distributed under the
// terms of the GNU General Public License (GPL)

package topali.data.models;

import java.util.*;

public class ModelManager
{
	//Lists of pre-initialized models
	private List<Model> dnaModels = new ArrayList<Model>();
	private List<Model> proteinModels = new ArrayList<Model>();
	
	private static ModelManager instance = null;
	
	private ModelManager() {
		initDNAModels();
		initProteinModels();
	}
	
	public static ModelManager getInstance() {
		if(instance==null)
			instance = new ModelManager();
		return instance;
	}
	
	public List<Model> listDNAModels() {
		return dnaModels;
	}
	
	public List<Model> listProteinModels() {
		return proteinModels;
	}
	
	public List<Model> listPhymlModels(boolean dna) {
		List<Model> result;
		if(dna) {
			return dnaModels;
		}
		else {
			result = new ArrayList<Model>();
			for(Model m : proteinModels) {
				if(m.is("jtt"))
					result.add(m);
				if(m.is("mtrev"))
					result.add(m);
				if(m.is("wag"))
					result.add(m);
				if(m.is("dcmut"))
					result.add(m);
				if(m.is("rtrev"))
					result.add(m);
				if(m.is("cprev"))
					result.add(m);
				if(m.is("vt"))
					result.add(m);
				if(m.is("blosum"))
					result.add(m);
				if(m.is("mtmam"))
					result.add(m);
				if(m.is("day"))
					result.add(m);
			}
			return result;
		}
	}
	
	public List<Model> listMrBayesModels(boolean dna) {
		List<Model> result;
		if(dna) {
			result = new ArrayList<Model>();
			for(Model m : dnaModels) {
				if(m.is("jc"))
					result.add(m);
				if(m.is("f81"))
					result.add(m);
				if(m.is("k80"))
					result.add(m);
				if(m.is("hky"))
					result.add(m);
				if(m.is("sym"))
					result.add(m);
				if(m.is("gtr"))
					result.add(m);
			}
			return result;
		}
		else {
			result = new ArrayList<Model>();
			for(Model m : proteinModels) {
				if(m.is("jtt"))
					result.add(m);
				if(m.is("day"))
					result.add(m);
				if(m.is("mtrev"))
					result.add(m);
				if(m.is("mtmam"))
					result.add(m);
				if(m.is("wag"))
					result.add(m);
				if(m.is("rtrev"))
					result.add(m);
				if(m.is("cprev"))
					result.add(m);
				if(m.is("vt"))
					result.add(m);
				if(m.is("blosum"))
					result.add(m);
			}
			return result;
		}
	}
	
	/**
	 * Generate a certain model
	 * @param name	Name of the model
	 * @param gamma Use gamma distribution
	 * @param inv   Use invariant sites
	 * @return
	 */
	public Model generateModel(String name, boolean gamma, boolean inv) {
		Model m = null;

		for(Model model : dnaModels) {
			if(model.is(name)) {
				m = new DNAModel((DNAModel)model);
				break;
			}
		}
		
		if(m==null) {
			for(Model model : proteinModels) {
				if(model.is(name)) {
					m = new ProteinModel((ProteinModel)model);
					break;
				}
			}
		}
		
		if(m!=null) {
			m.isGamma(gamma);
			m.isInv(inv);
		}
		
		return m;
	}
	
	public Model copy(Model model) {
		return generateModel(model.name, model.isGamma(), model.isInv());
	}
	
	/**
	 * Get the closest related model to a certain model
	 * @param m
	 * @return
	 */
	public Model getNearestModel(Model m) {
		if(m instanceof DNAModel) {
			int i = dnaModels.indexOf(m);
			if(i>0)
				return new DNAModel((DNAModel)dnaModels.get(i-1));
		}
		
		else if(m instanceof ProteinModel) {
			if(!((ProteinModel)m).isSpecialMatrix) {
				int i = proteinModels.indexOf(m);
				while(i>0) {
					i--;
					ProteinModel m2 = (ProteinModel)proteinModels.get(i);
					if(!m2.isSpecialMatrix())
						return new ProteinModel(m2);
				}
			}
		}
		
		return m;
	}
	
	private void initDNAModels() {
		DNAModel m = new DNAModel();
		m.setName("JC");
		m.addAlias("Jukes and Cantor,1969");
		m.setBaseFreqGroups('0','0','0','0');
		m.setSubRateGroups('0','0','0','0','0','0');
		dnaModels.add(m);
		
		m = new DNAModel();
		m.setName("F81");
		m.addAlias("Felsenstein,1981");
		m.setBaseFreqGroups('0','1','2','3');
		m.setSubRateGroups('0','0','0','0','0','0');
		dnaModels.add(m);
		
		m = new DNAModel();
		m.setName("K80");
		m.addAlias("K2P");
		m.addAlias("Kimura,1980");
		m.setBaseFreqGroups('0','0','0','0');
		m.setSubRateGroups('0','1','0','0','1','0');
		dnaModels.add(m);
		
		m = new DNAModel();
		m.setName("HKY");
		m.addAlias("HKY85");
		m.addAlias("Hasegawa, Kishino and Yano,1985");
		m.setBaseFreqGroups('0','1','2','3');
		m.setSubRateGroups('0','1','0','0','1','0');
		dnaModels.add(m);
		
		m = new DNAModel();
		m.setName("TrNef");
		m.addAlias("TrN, equal frequences");
		m.setBaseFreqGroups('0','0','0','0');
		m.setSubRateGroups('0','1','0','0','2','0');
		dnaModels.add(m);
		
		m = new DNAModel();
		m.setName("TrN");
		m.addAlias("TN");
		m.addAlias("TN93");
		m.addAlias("Tamura and Nei, 1993");
		m.setBaseFreqGroups('0','1','2','3');
		m.setSubRateGroups('0','1','0','0','2','0');
		dnaModels.add(m);
		
		m = new DNAModel();
		m.setName("K81");
		m.addAlias("K3P");
		m.addAlias("Kimura,1981");
		m.setBaseFreqGroups('0','0','0','0');
		m.setSubRateGroups('0','1','2','2','1','0');
		dnaModels.add(m);
		
		m = new DNAModel();
		m.setName("K81uf");
		m.addAlias("K3Puf");
		m.addAlias("K81, unequal frequences");
		m.setBaseFreqGroups('0','1','2','3');
		m.setSubRateGroups('0','1','2','2','1','0');
		dnaModels.add(m);
		
		m = new DNAModel();
		m.setName("TIMef");
		m.addAlias("TIM, equal frequences");
		m.setBaseFreqGroups('0','0','0','0');
		m.setSubRateGroups('0','1','2','2','3','0');
		dnaModels.add(m);
		
		m = new DNAModel();
		m.setName("TIM");
		m.addAlias("Transition Model");
		m.setBaseFreqGroups('0','1','2','3');
		m.setSubRateGroups('0','1','2','2','3','0');
		dnaModels.add(m);
		
		m = new DNAModel();
		m.setName("TVMef");
		m.addAlias("TVM, equal frequences");
		m.setBaseFreqGroups('0','0','0','0');
		m.setSubRateGroups('0','1','2','3','1','4');
		dnaModels.add(m);
		
		m = new DNAModel();
		m.setName("TVM");
		m.addAlias("Transversion Model");
		m.setBaseFreqGroups('0','1','2','3');
		m.setSubRateGroups('0','1','2','3','1','4');
		dnaModels.add(m);
		
		m = new DNAModel();
		m.setName("SYM");
		m.addAlias("Symmetrical Model");
		m.setBaseFreqGroups('0','0','0','0');
		m.setSubRateGroups('0','1','2','3','4','5');
		dnaModels.add(m);
		
		m = new DNAModel();
		m.setName("GTR");
		m.addAlias("General time reversible");
		m.setBaseFreqGroups('0','1','2','3');
		m.setSubRateGroups('0','1','2','3','4','5');
		dnaModels.add(m);
		
		Collections.sort(dnaModels);
	}

	private void initProteinModels() { 
		int i = 0;
		
		ProteinModel m = new ProteinModel();
		m.setName("Poisson");
		m.setRankScore(i++);
		initProteinParameters(m);
		proteinModels.add(m);
		
		m = new ProteinModel();
		m.setName("DAY");
		m.addAlias("Dayhoff");
		m.addAlias("Dayhoff PAM");
		m.setRankScore(i++);
		initProteinParameters(m);
		proteinModels.add(m);
		
		m = new ProteinModel();
		m.setName("Blosum");
		m.addAlias("Blosum62");
		m.setRankScore(i++);
		initProteinParameters(m);
		proteinModels.add(m);
	
		m = new ProteinModel();
		m.setName("JTT");
		m.addAlias("Jones");
		m.addAlias("Jones-Taylor-Thornton");
		m.setRankScore(i++);
		initProteinParameters(m);
		proteinModels.add(m);
		
		m = new ProteinModel();
		m.setName("VT");
		m.addAlias("Muller and Vingron,2000");
		m.addAlias("Vingron Resolvent Method");
		m.setRankScore(i++);
		initProteinParameters(m);
		proteinModels.add(m);
		
		m = new ProteinModel();
		m.setName("WAG");
		m.addAlias("Whelan and Goldman");
		m.setRankScore(i++);
		initProteinParameters(m);
		proteinModels.add(m);
		
		m = new ProteinModel();
		m.setName("DCMut");
		m.addAlias("Direct Computation with Mutabilities");
		m.setRankScore(i++);
		initProteinParameters(m);
		proteinModels.add(m);
		
		m = new ProteinModel();
		m.setName("GTR");
		m.addAlias("General Time Reversible");
		m.setRankScore(i++);
		initProteinParameters(m);
		proteinModels.add(m);
		
		
		//special models
		m = new ProteinModel();
		m.setName("RTRev");
		m.addAlias("Retroviral Proteins");
		m.isSpecialMatrix(true);
		m.setRankScore(i++);
		initProteinParameters(m);
		proteinModels.add(m);
		
		m = new ProteinModel();
		m.setName("CPRev");
		m.addAlias("Chloroplast Proteins");
		m.isSpecialMatrix(true);
		m.setRankScore(i++);
		initProteinParameters(m);
		proteinModels.add(m);
		
		m = new ProteinModel();
		m.setName("MTMam");
		m.addAlias("Mammalian Mitochondrial Proteins");
		m.isSpecialMatrix(true);
		m.setRankScore(i++);
		initProteinParameters(m);
		proteinModels.add(m);
		
		m = new ProteinModel();
		m.setName("MTArt");
		m.addAlias("Arthropoda Mitochondrial Proteins");
		m.isSpecialMatrix(true);
		m.setRankScore(i++);
		initProteinParameters(m);
		proteinModels.add(m);
		
		m = new ProteinModel();
		m.setName("MTRev");
		m.addAlias("Proteins encoded on Mitchondrial DNA");
		m.isSpecialMatrix(true);
		m.setRankScore(i++);
		initProteinParameters(m);
		proteinModels.add(m);
		
		Collections.sort(proteinModels);
	}
	
	private void initProteinParameters(ProteinModel mod) {
		double[] f = new double[20];
		double[][] rate = new double[20][20];
		
		if(mod.is("poisson")) {
			
		}
		else if(mod.is("day")) {
			//pal
			f[0] = 0.087; f[1] = 0.041; f[2] = 0.040; f[3] = 0.047;
			f[4] = 0.033; f[5] = 0.038; f[6] = 0.05; f[7] = 0.089;
			f[8] = 0.034; f[9] = 0.037; f[10] = 0.085; f[11] = 0.08;
			f[12] = 0.015; f[13] = 0.04; f[14] = 0.051; f[15] = 0.07;
			f[16] = 0.058; f[17] = 0.01; f[18] = 0.03; f[19] = 0.065;
			
			rate[0][1]=9.6472567159749e-01; 	rate[0][2]=3.5927991886410e+00;
			rate[0][3]=4.3200552414656e+00; 	rate[0][4]=1.3184584178499e+00;
			rate[0][5]=3.2267534963169e+00; 	rate[0][6]=7.0141987829615e+00;
			rate[0][7]=8.5773867857875e+00; 	rate[0][8]=8.1434196396611e-01;
			rate[0][9]=2.3518447453539e+00; 	rate[0][10]=1.4735711728911e+00;
			rate[0][11]=9.3940162271805e-01; 	rate[0][12]=2.5490196078431e+00;
			rate[0][13]=6.5922920892495e-01; 	rate[0][14]=8.9189834148670e+00;
			rate[0][15]=1.4540712836859e+01; 	rate[0][16]=1.3411904595370e+01;
			rate[0][17]=3.8517964118027e-02; 	rate[0][18]=8.7897227856660e-01;
			rate[0][19]=7.4036511156187e+00;

			rate[1][2]=1.1890243902439e+00; 	rate[1][3]=5.9525626545377e-02;
			rate[1][4]=8.4778922655537e-01; 	rate[1][5]=8.8348561504191e+00;
			rate[1][6]=5.5954088952654e-02; 	rate[1][7]=3.1434881434075e-01;
			rate[1][8]=8.4753987678285e+00; 	rate[1][9]=2.2684090115941e+00;
			rate[1][10]=5.5954088952654e-01; 	rate[1][11]=1.6681312769010e+01;
			rate[1][12]=3.1707317073171e+00; 	rate[1][13]=4.8959827833572e-01;
			rate[1][14]=3.6754156468900e+00; 	rate[1][15]=5.4755072760812e+00;
			rate[1][16]=9.6472567159749e-01; 	rate[1][17]=7.5538020086083e+00;
			rate[1][18]=2.7977044476327e-01; 	rate[1][19]=8.6083213773314e-01;

			rate[2][3]=3.2459324155194e+01; 	rate[2][4]=7.3852625416383e-02;
			rate[2][5]=3.7732198142415e+00; 	rate[2][6]=5.3911764705882e+00;
			rate[2][7]=5.0264375413087e+00; 	rate[2][8]=1.9061418685121e+01;
			rate[2][9]=2.7901430842607e+00; 	rate[2][10]=1.2482698961938e+00;
			rate[2][11]=1.1542279411765e+01; 	rate[2][12]=1.9117647058824e-01;
			rate[2][13]=5.0183823529412e-01; 	rate[2][14]=1.5181660899654e+00;
			rate[2][15]=1.7697478991597e+01; 	rate[2][16]=8.3557302231237e+00;
			rate[2][17]=8.6029411764706e-01; 	rate[2][18]=3.4411764705882e+00;
			rate[2][19]=5.7352941176471e-01;

			rate[3][4]=2.5534152404601e-02; 	rate[3][5]=4.8811013767209e+00;
			rate[3][6]=4.0561952440551e+01; 	rate[3][7]=4.4423506911730e+00;
			rate[3][8]=3.0865788117500e+00; 	rate[3][9]=8.5749078239692e-01;
			rate[3][10]=2.5926985518518e-02; 	rate[3][11]=2.5930851063830e+00;
			rate[3][12]=1.1667143483333e-01; 	rate[3][13]=1.2963492759259e-02;
			rate[3][14]=4.7853935065891e-01; 	rate[3][15]=3.4167709637046e+00;
			rate[3][16]=2.3984722282163e+00; 	rate[3][17]=3.2408731898147e-02;
			rate[3][18]=8.1351689612015e-02; 	rate[3][19]=6.3829787234043e-01;

			rate[4][5]=2.1864264103535e-02; 	rate[4][6]=1.4770525083277e-02;
			rate[4][7]=3.9055458751427e-01; 	rate[4][8]=1.0223340673168e+00;
			rate[4][9]=1.5970515970516e+00; 	rate[4][10]=3.9098448749850e-02;
			rate[4][11]=8.0776309049169e-03; 	rate[4][12]=1.4155086538140e-01;
			rate[4][13]=8.6898395721925e-02; 	rate[4][14]=6.8155604487784e-01;
			rate[4][15]=5.8097784568373e+00; 	rate[4][16]=5.9929928084086e-01;
			rate[4][17]=3.4759358288770e-01; 	rate[4][18]=3.4759358288770e+00;
			rate[4][19]=1.7647058823529e+00;

			rate[5][6]=2.5476780185759e+01; 	rate[5][7]=1.0174974779977e+00;
			rate[5][8]=2.1573939173192e+01; 	rate[5][9]=6.5266504894988e-01;
			rate[5][10]=2.6634492806410e+00; 	rate[5][11]=5.5466331269350e+00;
			rate[5][12]=4.0247678018576e+00; 	rate[5][13]=1.8038017885416e-02;
			rate[5][14]=5.5044618466582e+00; 	rate[5][15]=2.0267580716497e+00;
			rate[5][16]=1.9256432155439e+00; 	rate[5][17]=9.6202762055552e-02;
			rate[5][18]=1.0061919504644e-01; 	rate[5][19]=1.2538699690402e+00;

			rate[6][7]=2.8869795109055e+00; 	rate[6][8]=1.5519031141869e+00;
			rate[6][9]=2.1701112877583e+00; 	rate[6][10]=4.0484429065744e-01;
			rate[6][11]=2.9823529411765e+00; 	rate[6][12]=1.0705882352941e+00;
			rate[6][13]=1.9801735189768e-02; 	rate[6][14]=1.7993079584775e+00;
			rate[6][15]=2.8184873949580e+00; 	rate[6][16]=1.2261663286004e+00;
			rate[6][17]=7.3114099162219e-02; 	rate[6][18]=7.6470588235294e-01;
			rate[6][19]=1.3058823529412e+00;

			rate[7][8]=3.7906768788150e-01; 	rate[7][9]=2.3128004846840e-02;
			rate[7][10]=2.5776602775942e-01; 	rate[7][11]=9.6662260409782e-01;
			rate[7][12]=6.0145406477198e-01; 	rate[7][13]=5.4775280898876e-01;
			rate[7][14]=1.2382877804129e+00; 	rate[7][15]=8.2853366065527e+00;
			rate[7][16]=1.1110604644803e+00; 	rate[7][17]=1.2888301387971e-01;
			rate[7][18]=1.7114723586662e-02; 	rate[7][19]=1.9233311302049e+00;

			rate[8][9]=2.7354343963341e-01; 	rate[8][10]=1.5876246692449e+00;
			rate[8][11]=9.6993944636678e-01; 	rate[8][12]=1.2544085640577e-01;
			rate[8][13]=1.6868512110727e+00; 	rate[8][14]=3.3075513942601e+00;
			rate[8][15]=1.2530894710826e+00; 	rate[8][16]=8.1434196396611e-01;
			rate[8][17]=1.0121107266436e+00; 	rate[8][18]=4.4982698961938e+00;
			rate[8][19]=1.5570934256055e+00;

			rate[9][10]=9.2275320303002e+00; 	rate[9][11]=1.6663354531002e+00;
			rate[9][12]=1.1780604133545e+01; 	rate[9][13]=6.9753577106518e+00;
			rate[9][14]=4.2551201720752e-01; 	rate[9][15]=8.8575970928912e-01;
			rate[9][16]=6.8951811852420e+00; 	rate[9][17]=9.8802836705702e-02;
			rate[9][18]=1.3434022257552e+00; 	rate[9][19]=3.1526232114467e+01;

			rate[10][11]=6.5787197231834e-01; 	rate[10][12]=1.8622837370242e+01;
			rate[10][13]=5.6340830449827e+00; 	rate[10][14]=1.1377976796255e+00;
			rate[10][15]=6.1690558576372e-01; 	rate[10][16]=1.2098794893211e+00;
			rate[10][17]=1.7543252595156e+00; 	rate[10][18]=1.0346020761246e+00;
			rate[10][19]=6.2906574394464e+00;

			rate[11][12]=8.6029411764706e+00; 	rate[11][13]=6.6640454965565e-03;
			rate[11][14]=1.2089100346021e+00; 	rate[11][15]=3.4411764705882e+00;
			rate[11][16]=4.9442190669371e+00; 	rate[11][17]=3.4272233982290e-02;
			rate[11][18]=4.7794117647059e-01; 	rate[11][19]=3.7500000000000e-01;

			rate[12][13]=3.2500000000000e+00; 	rate[12][14]=5.9976931949250e-01;
			rate[12][15]=2.1848739495798e+00; 	rate[12][16]=3.6916835699797e+00;
			rate[12][17]=1.6247577591604e-01; 	rate[12][18]=1.1508700794053e-01;
			rate[12][19]=9.0588235294118e+00;

			rate[13][14]=3.9359861591695e-01; 	rate[13][15]=1.6386554621849e+00;
			rate[13][16]=4.9442190669371e-01; 	rate[13][17]=2.8676470588235e+00;
			rate[13][18]=2.4852941176471e+01; 	rate[13][19]=4.4117647058824e-01;

			rate[14][15]=8.6431043005437e+00; 	rate[14][16]=2.8308077795013e+00;
			rate[14][17]=3.5840244687362e-02; 	rate[14][18]=4.3804743506776e-02;
			rate[14][19]=1.7301038062284e+00;

			rate[15][16]=1.9663865546218e+01; 	rate[15][17]=2.7857142857143e+00;
			rate[15][18]=1.2016806722689e+00; 	rate[15][19]=1.0840336134454e+00;

			rate[16][17]=4.2019597219666e-02; 	rate[16][18]=1.5162271805274e+00;
			rate[16][19]=5.6592292089249e+00;

			rate[17][18]=2.2941176470588e+00; 	rate[17][19]=1.2654363316538e-01;

			rate[18][19]=1.0000000000000e+00;
		}
		else if(mod.is("blosum")) {
			//pal
			f[0]=0.074; f[1]=0.052; f[2]=0.045; f[3]=0.054;
			f[4]=0.025; f[5]=0.034; f[6]=0.054; f[7]=0.074;
			f[8]=0.026; f[9]=0.068; f[10]=0.099; f[11]=0.058;
			f[12]=0.025; f[13]=0.047; f[14]=0.039; f[15]=0.057;
			f[16]=0.051; f[17]=0.013; f[18]=0.032; f[19]=0.073;
			
			rate[0][1]=7.3579038969751e-01; 	rate[0][2]=4.8539105546575e-01;
			rate[0][3]=5.4316182089867e-01; 	rate[0][4]=1.4599953104700e+00;
			rate[0][5]=1.1997057046020e+00; 	rate[0][6]=1.1709490427999e+00;
			rate[0][7]=1.9558835749595e+00; 	rate[0][8]=7.1624144499779e-01;
			rate[0][9]=6.0589900368677e-01; 	rate[0][10]=8.0001653051838e-01;
			rate[0][11]=1.2952012667833e+00; 	rate[0][12]=1.2537582666635e+00;
			rate[0][13]=4.9296467974759e-01; 	rate[0][14]=1.1732759009239e+00;
			rate[0][15]=4.3250926870566e+00; 	rate[0][16]=1.7291780194850e+00;
			rate[0][17]=4.6583936772479e-01; 	rate[0][18]=7.1820669758623e-01;
			rate[0][19]=2.1877745220045e+00;

			rate[1][2]=1.2974467051337e+00; 	rate[1][3]=5.0096440855513e-01;
			rate[1][4]=2.2782657420895e-01; 	rate[1][5]=3.0208336100636e+00;
			rate[1][6]=1.3605741904203e+00; 	rate[1][7]=4.1876330851753e-01;
			rate[1][8]=1.4561411663360e+00; 	rate[1][9]=2.3203644514174e-01;
			rate[1][10]=6.2271166969249e-01; 	rate[1][11]=5.4111151414889e+00;
			rate[1][12]=9.8369298745695e-01; 	rate[1][13]=3.7164469320875e-01;
			rate[1][14]=4.4813366171831e-01; 	rate[1][15]=1.1227831042096e+00;
			rate[1][16]=9.1466595456337e-01; 	rate[1][17]=4.2638231012175e-01;
			rate[1][18]=7.2051744121611e-01; 	rate[1][19]=4.3838834377202e-01;

			rate[2][3]=3.1801000482161e+00; 	rate[2][4]=3.9735894989702e-01;
			rate[2][5]=1.8392161469920e+00; 	rate[2][6]=1.2404885086396e+00;
			rate[2][7]=1.3558723444845e+00; 	rate[2][8]=2.4145014342081e+00;
			rate[2][9]=2.8301732627800e-01; 	rate[2][10]=2.1188815961519e-01;
			rate[2][11]=1.5931370434574e+00; 	rate[2][12]=6.4844127878707e-01;
			rate[2][13]=3.5486124922252e-01; 	rate[2][14]=4.9488704370192e-01;
			rate[2][15]=2.9041016564560e+00; 	rate[2][16]=1.8981736345332e+00;
			rate[2][17]=1.9148204624678e-01; 	rate[2][18]=5.3822251903674e-01;
			rate[2][19]=3.1285879799342e-01;

			rate[3][4]=2.4083661480204e-01; 	rate[3][5]=1.1909457033960e+00;
			rate[3][6]=3.7616252083685e+00; 	rate[3][7]=7.9847324896839e-01;
			rate[3][8]=7.7814266402188e-01; 	rate[3][9]=4.1855573246161e-01;
			rate[3][10]=2.1813157759360e-01; 	rate[3][11]=1.0324479249521e+00;
			rate[3][12]=2.2262189795786e-01; 	rate[3][13]=2.8173069420651e-01;
			rate[3][14]=7.3062827299842e-01; 	rate[3][15]=1.5827541420653e+00;
			rate[3][16]=9.3418750943056e-01; 	rate[3][17]=1.4534504627853e-01;
			rate[3][18]=2.6142220896504e-01; 	rate[3][19]=2.5812928941763e-01;

			rate[4][5]=3.2980150463028e-01; 	rate[4][6]=1.4074889181440e-01;
			rate[4][7]=4.1820319228376e-01; 	rate[4][8]=3.5405810983129e-01;
			rate[4][9]=7.7489402279418e-01; 	rate[4][10]=8.3184264014158e-01;
			rate[4][11]=2.8507880090648e-01; 	rate[4][12]=7.6768882347954e-01;
			rate[4][13]=4.4133747118660e-01; 	rate[4][14]=3.5600849876863e-01;
			rate[4][15]=1.1971884150942e+00; 	rate[4][16]=1.1198313585160e+00;
			rate[4][17]=5.2766441887169e-01; 	rate[4][18]=4.7023773369610e-01;
			rate[4][19]=1.1163524786062e+00;

			rate[5][6]=5.5289191779282e+00; 	rate[5][7]=6.0984630538281e-01;
			rate[5][8]=2.4353411311401e+00; 	rate[5][9]=2.3620245120365e-01;
			rate[5][10]=5.8073709318144e-01; 	rate[5][11]=3.9452776745146e+00;
			rate[5][12]=2.4948960771127e+00; 	rate[5][13]=1.4435695975031e-01;
			rate[5][14]=8.5857057567418e-01; 	rate[5][15]=1.9348709245965e+00;
			rate[5][16]=1.2774802945956e+00; 	rate[5][17]=7.5865380864172e-01;
			rate[5][18]=9.5898974285014e-01; 	rate[5][19]=5.3078579012486e-01;

			rate[6][7]=4.2357999217628e-01; 	rate[6][8]=1.6268910569817e+00;
			rate[6][9]=1.8684804693170e-01; 	rate[6][10]=3.7262517508685e-01;
			rate[6][11]=2.8024271516787e+00; 	rate[6][12]=5.5541539747043e-01;
			rate[6][13]=2.9140908416530e-01; 	rate[6][14]=9.2656393484598e-01;
			rate[6][15]=1.7698932389373e+00; 	rate[6][16]=1.0710972360073e+00;
			rate[6][17]=4.0763564893830e-01; 	rate[6][18]=5.9671930034577e-01;
			rate[6][19]=5.2425384633796e-01;

			rate[7][8]=5.3985912495418e-01; 	rate[7][9]=1.8929629237636e-01;
			rate[7][10]=2.1772115923623e-01; 	rate[7][11]=7.5204244030271e-01;
			rate[7][12]=4.5943617357855e-01; 	rate[7][13]=3.6816646445253e-01;
			rate[7][14]=5.0408659952683e-01; 	rate[7][15]=1.5093262532236e+00;
			rate[7][16]=6.4143601140497e-01; 	rate[7][17]=5.0835892463812e-01;
			rate[7][18]=3.0805573703500e-01; 	rate[7][19]=2.5334079019018e-01;

			rate[8][9]=2.5271844788492e-01; 	rate[8][10]=3.4807220979697e-01;
			rate[8][11]=1.0225070358890e+00; 	rate[8][12]=9.8431152535870e-01;
			rate[8][13]=7.1453370392764e-01; 	rate[8][14]=5.2700733915060e-01;
			rate[8][15]=1.1170297629105e+00; 	rate[8][16]=5.8540709022472e-01;
			rate[8][17]=3.0124860078016e-01; 	rate[8][18]=4.2189539693890e+00;
			rate[8][19]=2.0155597175031e-01;

			rate[9][10]=3.8909637733035e+00; 	rate[9][11]=4.0619358664202e-01;
			rate[9][12]=3.3647977631042e+00; 	rate[9][13]=1.5173593259539e+00;
			rate[9][14]=3.8835540920564e-01; 	rate[9][15]=3.5754441245967e-01;
			rate[9][16]=1.1790911972601e+00; 	rate[9][17]=3.4198578754023e-01;
			rate[9][18]=6.7461709322842e-01; 	rate[9][19]=8.3118394054582e+00;

			rate[10][11]=4.4557027426059e-01; 	rate[10][12]=6.0305593795716e+00;
			rate[10][13]=2.0648397032375e+00; 	rate[10][14]=3.7455568747097e-01;
			rate[10][15]=3.5296918452729e-01; 	rate[10][16]=9.1525985769421e-01;
			rate[10][17]=6.9147463459998e-01; 	rate[10][18]=8.1124585632307e-01;
			rate[10][19]=2.2314056889131e+00;

			rate[11][12]=1.0730611843319e+00; 	rate[11][13]=2.6692475051102e-01;
			rate[11][14]=1.0473834507215e+00; 	rate[11][15]=1.7521659178195e+00;
			rate[11][16]=1.3038752007987e+00; 	rate[11][17]=3.3224304063396e-01;
			rate[11][18]=7.1799348690032e-01; 	rate[11][19]=4.9813847530407e-01;

			rate[12][13]=1.7738551688305e+00; 	rate[12][14]=4.5412362510273e-01;
			rate[12][15]=9.1872341574605e-01; 	rate[12][16]=1.4885480537218e+00;
			rate[12][17]=8.8810109815193e-01; 	rate[12][18]=9.5168216224591e-01;
			rate[12][19]=2.5758507553153e+00;

			rate[13][14]=2.3359790962888e-01; 	rate[13][15]=5.4002764482413e-01;
			rate[13][16]=4.8820611879305e-01; 	rate[13][17]=2.0743248934965e+00;
			rate[13][18]=6.7472604308008e+00; 	rate[13][19]=8.3811961017754e-01;

			rate[14][15]=1.1691295777157e+00; 	rate[14][16]=1.0054516831488e+00;
			rate[14][17]=2.5221483002727e-01; 	rate[14][18]=3.6940531935451e-01;
			rate[14][19]=4.9690841067567e-01;

			rate[15][16]=5.1515562922704e+00; 	rate[15][17]=3.8792562209837e-01;
			rate[15][18]=7.9675152076106e-01; 	rate[15][19]=5.6192545744165e-01;

			rate[16][17]=5.1312812689059e-01; 	rate[16][18]=8.0101024319939e-01;
			rate[16][19]=2.2530740511763e+00;

			rate[17][18]=4.0544190065580e+00; 	rate[17][19]=2.6650873142646e-01;

			rate[18][19]=1.0000000000000e+00;
		}
		else if(mod.is("jtt")) {
			//pal
			f[0] = 0.077; f[1] = 0.051; f[2] = 0.043; f[3] = 0.052;
			f[4] = 0.02; f[5] = 0.041; f[6] = 0.062; f[7] = 0.074;
			f[8] = 0.023; f[9] = 0.052; f[10] = 0.091; f[11] = 0.059;
			f[12] = 0.024; f[13] = 0.04; f[14] = 0.051; f[15] = 0.069;
			f[16] = 0.059; f[17] = 0.014; f[18] = 0.032; f[19] = 0.066;
			
			rate[0][1]=3.1628651460584e+00; 	rate[0][2]=3.2804935927860e+00;
			rate[0][3]=4.8477237048666e+00; 	rate[0][4]=3.4612244897959e+00;
			rate[0][5]=3.3130910900946e+00; 	rate[0][6]=6.3199473337722e+00;
			rate[0][7]=1.0440154440154e+01; 	rate[0][8]=1.3061224489796e+00;
			rate[0][9]=2.1726844583987e+00; 	rate[0][10]=1.8443597219107e+00;
			rate[0][11]=2.2137668626773e+00; 	rate[0][12]=2.7210884353741e+00;
			rate[0][13]=8.3265306122449e-01; 	rate[0][14]=1.1537414965986e+01;
			rate[0][15]=2.2838213546288e+01; 	rate[0][16]=2.7007955724663e+01;
			rate[0][17]=5.1311953352770e-01; 	rate[0][18]=8.3673469387755e-01;
			rate[0][19]=1.7474335188621e+01;

			rate[1][2]=2.6598918637222e+00; 	rate[1][3]=9.1014867485456e-01;
			rate[1][4]=6.1624649859944e+00; 	rate[1][5]=1.8036482885837e+01;
			rate[1][6]=1.8924731182796e+00; 	rate[1][7]=8.1810886516769e+00;
			rate[1][8]=1.9119717452198e+01; 	rate[1][9]=1.4410687351864e+00;
			rate[1][10]=2.2211961707760e+00; 	rate[1][11]=3.9239234676922e+01;
			rate[1][12]=2.5060690943044e+00; 	rate[1][13]=3.9439775910364e-01;
			rate[1][14]=4.1953094963476e+00; 	rate[1][15]=5.9016766126741e+00;
			rate[1][16]=3.8437069743152e+00; 	rate[1][17]=7.6766706682673e+00;
			rate[1][18]=1.4173669467787e+00; 	rate[1][19]=1.0308123249300e+00;

			rate[2][3]=3.2226935854843e+01; 	rate[2][4]=1.8710963455150e+00;
			rate[2][5]=4.5351268130622e+00; 	rate[2][6]=3.3951344979102e+00;
			rate[2][7]=4.5987249708180e+00; 	rate[2][8]=2.3693774375271e+01;
			rate[2][9]=2.9235880398671e+00; 	rate[2][10]=8.0960899565551e-01;
			rate[2][11]=1.5024269384537e+01; 	rate[2][12]=1.9003322259136e+00;
			rate[2][13]=4.3853820598007e-01; 	rate[2][14]=7.1083317047749e-01;
			rate[2][15]=2.9456208772690e+01; 	rate[2][16]=1.3735908553410e+01;
			rate[2][17]=1.6706217370669e-01; 	rate[2][18]=4.1661129568106e+00;
			rate[2][19]=9.7452934662237e-01;

			rate[3][4]=6.2857142857143e-01; 	rate[3][5]=3.0662020905923e+00;
			rate[3][6]=4.5450549450549e+01; 	rate[3][7]=7.5402435402435e+00;
			rate[3][8]=6.0544672718586e+00; 	rate[3][9]=6.8808114961961e-01;
			rate[3][10]=3.6130902064968e-01; 	rate[3][11]=1.6718197057180e+00;
			rate[3][12]=1.0879120879121e+00; 	rate[3][13]=1.9340659340659e-01;
			rate[3][14]=7.3949579831933e-01; 	rate[3][15]=3.4196528109572e+00;
			rate[3][16]=2.4749487800335e+00; 	rate[3][17]=3.4536891679749e-01;
			rate[3][18]=2.6895604395604e+00; 	rate[3][19]=1.8608058608059e+00;

			rate[4][5]=5.5191637630662e-01; 	rate[4][6]=3.2442396313364e-01;
			rate[4][7]=3.3297297297297e+00; 	rate[4][8]=4.3726708074534e+00;
			rate[4][9]=9.1868131868132e-01; 	rate[4][10]=9.9466248037677e-01;
			rate[4][11]=2.9830508474576e-01; 	rate[4][12]=2.4095238095238e+00;
			rate[4][13]=4.1485714285714e+00; 	rate[4][14]=7.3949579831933e-01;
			rate[4][15]=1.2862939958592e+01; 	rate[4][16]=2.8125907990315e+00;
			rate[4][17]=6.8244897959184e+00; 	rate[4][18]=1.2885714285714e+01;
			rate[4][19]=3.7714285714286e+00;

			rate[5][6]=2.0316061593796e+01; 	rate[5][7]=1.3922214897825e+00;
			rate[5][8]=3.3861536130889e+01; 	rate[5][9]=4.7172339855267e-01;
			rate[5][10]=4.2320327755868e+00; 	rate[5][11]=1.7835941652395e+01;
			rate[5][12]=2.6573751451800e+00; 	rate[5][13]=2.7595818815331e-01;
			rate[5][14]=9.4992143198743e+00; 	rate[5][15]=3.2350653941322e+00;
			rate[5][16]=3.0973838067678e+00; 	rate[5][17]=1.0512692882031e+00;
			rate[5][18]=1.5331010452962e+00; 	rate[5][19]=1.0778164924506e+00;

			rate[6][7]=6.6857641051189e+00; 	rate[6][8]=1.4458024443999e+00;
			rate[6][9]=6.7068415455512e-01; 	rate[6][10]=5.7932850559579e-01;
			rate[6][11]=1.0365070686558e+01; 	rate[6][12]=1.0138248847926e+00;
			rate[6][13]=2.6359447004608e-01; 	rate[6][14]=1.1291226167887e+00;
			rate[6][15]=1.8337006611901e+00; 	rate[6][16]=1.9520424900414e+00;
			rate[6][17]=6.9519420671494e-01; 	rate[6][18]=3.8018433179723e-01;
			rate[6][19]=2.7772657450077e+00;

			rate[7][8]=1.2113479939567e+00; 	rate[7][9]=3.2670032670033e-01;
			rate[7][10]=4.1817641817642e-01; 	rate[7][11]=1.6354950592239e+00;
			rate[7][12]=7.6447876447876e-01; 	rate[7][13]=3.0579150579151e-01;
			rate[7][14]=1.2391551215081e+00; 	rate[7][15]=1.1138492529797e+01;
			rate[7][16]=1.8888816176952e+00; 	rate[7][17]=3.3491450634308e+00;
			rate[7][18]=3.1853281853282e-01; 	rate[7][19]=2.8416988416988e+00;

			rate[8][9]=1.0931677018634e+00; 	rate[8][10]=3.2194389461470e+00;
			rate[8][11]=3.1498052426571e+00; 	rate[8][12]=1.9130434782609e+00;
			rate[8][13]=2.7329192546584e+00; 	rate[8][14]=6.7304834977469e+00;
			rate[8][15]=4.3726708074534e+00; 	rate[8][16]=2.8162964522581e+00;
			rate[8][17]=7.8083407275954e-01; 	rate[8][18]=3.5118012422360e+01;
			rate[8][19]=7.2877846790890e-01;

			rate[9][10]=1.4069798333535e+01; 	rate[9][11]=1.2292791953809e+00;
			rate[9][12]=2.8366300366300e+01; 	rate[9][13]=4.7384615384615e+00;
			rate[9][14]=5.8780435251023e-01; 	rate[9][15]=2.4105749323141e+00;
			rate[9][16]=1.5243062022723e+01; 	rate[9][17]=8.2888540031397e-01;
			rate[9][18]=1.8434065934066e+00; 	rate[9][19]=5.7699633699634e+01;

			rate[10][11]=8.8039805231089e-01; 	rate[10][12]=2.2425954997384e+01;
			rate[10][13]=1.5099529042386e+01; 	rate[10][14]=6.2626896912611e+00;
			rate[10][15]=3.4917298022888e+00; 	rate[10][16]=1.6109411169944e+00;
			rate[10][17]=3.2366001345593e+00; 	rate[10][18]=1.4505494505495e+00;
			rate[10][19]=1.0557823129252e+01;

			rate[11][12]=3.6577885391445e+00; 	rate[11][13]=1.4915254237288e-01;
			rate[11][14]=1.2868062479229e+00; 	rate[11][15]=2.8162964522581e+00;
			rate[11][16]=5.7494151926786e+00; 	rate[11][17]=5.4790729851263e-01;
			rate[11][18]=5.3268765133172e-01; 	rate[11][19]=7.4899112187248e-01;

			rate[12][13]=2.5666666666667e+00; 	rate[12][14]=9.4491129785247e-01;
			rate[12][15]=1.6397515527950e+00; 	rate[12][16]=1.2180790960452e+01;
			rate[12][17]=1.1972789115646e+00; 	rate[12][18]=1.1130952380952e+00;
			rate[12][19]=1.7746031746032e+01;

			rate[13][14]=8.8739495798319e-01; 	rate[13][15]=5.6298136645963e+00;
			rate[13][16]=8.3099273607748e-01; 	rate[13][17]=3.3224489795918e+00;
			rate[13][18]=3.3392857142857e+01; 	rate[13][19]=3.6000000000000e+00;

			rate[14][15]=1.6261762676085e+01; 	rate[14][16]=6.8852490148602e+00;
			rate[14][17]=4.2256902761104e-01; 	rate[14][18]=6.7787114845938e-01;
			rate[14][19]=1.2549019607843e+00;

			rate[15][16]=2.7891216619293e+01; 	rate[15][17]=1.8740017746229e+00;
			rate[15][18]=3.7349896480331e+00; 	rate[15][19]=2.4182194616977e+00;

			rate[16][17]=4.8702870978900e-01; 	rate[16][18]=1.1985472154964e+00;
			rate[16][19]=6.7925746569814e+00;

			rate[17][18]=4.6020408163265e+00; 	rate[17][19]=1.4693877551020e+00;

			rate[18][19]=1.0000000000000e+00;
		}
		else if(mod.is("vt")) {
			//pal
			f[0]=0.078837 ;
			f[1]=0.051238 ;
			f[2]=0.042313 ;
			f[3]=0.053066 ;
			f[4]=0.015175 ;
			f[5]=0.036713 ;
			f[6]=0.061924 ;
			f[7]=0.070852 ;
			f[8]=0.023082 ;
			f[9]=0.062056 ;
			f[10]=0.096371 ;
			f[11]=0.057324 ;
			f[12]=0.023771 ;
			f[13]=0.043296 ;
			f[14]=0.043911 ;
			f[15]=0.063403 ;
			f[16]=0.055897 ;
			f[17]=0.013272 ;
			f[18]=0.034399 ;
			f[19]=0.073101 ;
			
			rate[0][1] = 0.233108 ; rate[0][2] = 0.199097 ;
			rate[0][3] = 0.265145 ; rate[0][4] = 0.227333 ;
			rate[0][5] = 0.310084 ; rate[0][6] = 0.567957 ;
			rate[0][7] = 0.876213 ; rate[0][8] = 0.078692 ;
			rate[0][9] = 0.222972 ; rate[0][10] = 0.424630 ;
			rate[0][11] = 0.393245 ; rate[0][12] = 0.211550 ;
			rate[0][13] = 0.116646 ; rate[0][14] = 0.399143 ;
			rate[0][15] = 1.817198 ; rate[0][16] = 0.877877 ;
			rate[0][17] = 0.030309 ; rate[0][18] = 0.087061 ;
			rate[0][19] = 1.230985 ;

			rate[1][2] = 0.210797 ; rate[1][3] = 0.105191 ;
			rate[1][4] = 0.031726 ; rate[1][5] = 0.493763 ;
			rate[1][6] = 0.255240 ; rate[1][7] = 0.156945 ;
			rate[1][8] = 0.213164 ; rate[1][9] = 0.081510 ;
			rate[1][10] = 0.192364 ; rate[1][11] = 1.755838 ;
			rate[1][12] = 0.087930 ; rate[1][13] = 0.042569 ;
			rate[1][14] = 0.128480 ; rate[1][15] = 0.292327 ;
			rate[1][16] = 0.204109 ; rate[1][17] = 0.046417 ;
			rate[1][18] = 0.097010 ; rate[1][19] = 0.113146 ;

			rate[2][3] = 0.883422 ; rate[2][4] = 0.027495 ;
			rate[2][5] = 0.275700 ; rate[2][6] = 0.270417 ;
			rate[2][7] = 0.362028 ; rate[2][8] = 0.290006 ;
			rate[2][9] = 0.087225 ; rate[2][10] = 0.069245 ;
			rate[2][11] = 0.503060 ; rate[2][12] = 0.057420 ;
			rate[2][13] = 0.039769 ; rate[2][14] = 0.083956 ;
			rate[2][15] = 0.847049 ; rate[2][16] = 0.471268 ;
			rate[2][17] = 0.010459 ; rate[2][18] = 0.093268 ;
			rate[2][19] = 0.049824 ;

			rate[3][4] = 0.010313 ; rate[3][5] = 0.205842 ;
			rate[3][6] = 1.599461 ; rate[3][7] = 0.311718 ;
			rate[3][8] = 0.134252 ; rate[3][9] = 0.011720 ;
			rate[3][10] = 0.060863 ; rate[3][11] = 0.261101 ;
			rate[3][12] = 0.012182 ; rate[3][13] = 0.016577 ;
			rate[3][14] = 0.160063 ; rate[3][15] = 0.461519 ;
			rate[3][16] = 0.178197 ; rate[3][17] = 0.011393 ;
			rate[3][18] = 0.051664 ; rate[3][19] = 0.048769 ;

			rate[4][5] = 0.004315 ; rate[4][6] = 0.005321 ;
			rate[4][7] = 0.050876 ; rate[4][8] = 0.016695 ;
			rate[4][9] = 0.046398 ; rate[4][10] = 0.091709 ;
			rate[4][11] = 0.004067 ; rate[4][12] = 0.023690 ;
			rate[4][13] = 0.051127 ; rate[4][14] = 0.011137 ;
			rate[4][15] = 0.175270 ; rate[4][16] = 0.079511 ;
			rate[4][17] = 0.007732 ; rate[4][18] = 0.042823 ;
			rate[4][19] = 0.163831 ;

			rate[5][6] = 0.960976 ; rate[5][7] = 0.128660 ;
			rate[5][8] = 0.315521 ; rate[5][9] = 0.054602 ;
			rate[5][10] = 0.243530 ; rate[5][11] = 0.738208 ;
			rate[5][12] = 0.120801 ; rate[5][13] = 0.026235 ;
			rate[5][14] = 0.156570 ; rate[5][15] = 0.358017 ;
			rate[5][16] = 0.248992 ; rate[5][17] = 0.021248 ;
			rate[5][18] = 0.062544 ; rate[5][19] = 0.112027 ;

			rate[6][7] = 0.250447 ; rate[6][8] = 0.104458 ;
			rate[6][9] = 0.046589 ; rate[6][10] = 0.151924 ;
			rate[6][11] = 0.888630 ; rate[6][12] = 0.058643 ;
			rate[6][13] = 0.028168 ; rate[6][14] = 0.205134 ;
			rate[6][15] = 0.406035 ; rate[6][16] = 0.321028 ;
			rate[6][17] = 0.018844 ; rate[6][18] = 0.055200 ;
			rate[6][19] = 0.205868 ;

			rate[7][8] = 0.058131 ; rate[7][9] = 0.051089 ;
			rate[7][10] = 0.087056 ; rate[7][11] = 0.193243 ;
			rate[7][12] = 0.046560 ; rate[7][13] = 0.050143 ;
			rate[7][14] = 0.124492 ; rate[7][15] = 0.612843 ;
			rate[7][16] = 0.136266 ; rate[7][17] = 0.023990 ;
			rate[7][18] = 0.037568 ; rate[7][19] = 0.082579 ;

			rate[8][9] = 0.020039 ; rate[8][10] = 0.103552 ;
			rate[8][11] = 0.153323 ; rate[8][12] = 0.021157 ;
			rate[8][13] = 0.079807 ; rate[8][14] = 0.078892 ;
			rate[8][15] = 0.167406 ; rate[8][16] = 0.101117 ;
			rate[8][17] = 0.020009 ; rate[8][18] = 0.286027 ;
			rate[8][19] = 0.068575 ;

			rate[9][10] = 2.089890 ; rate[9][11] = 0.093181 ;
			rate[9][12] = 0.493845 ; rate[9][13] = 0.321020 ;
			rate[9][14] = 0.054797 ; rate[9][15] = 0.081567 ;
			rate[9][16] = 0.376588 ; rate[9][17] = 0.034954 ;
			rate[9][18] = 0.086237 ; rate[9][19] = 3.654430 ;

			rate[10][11] = 0.201204 ; rate[10][12] = 1.105667 ;
			rate[10][13] = 0.946499 ; rate[10][14] = 0.169784 ;
			rate[10][15] = 0.214977 ; rate[10][16] = 0.243227 ;
			rate[10][17] = 0.083439 ; rate[10][18] = 0.189842 ;
			rate[10][19] = 1.337571 ;

			rate[11][12] = 0.096474 ; rate[11][13] = 0.038261 ;
			rate[11][14] = 0.212302 ; rate[11][15] = 0.400072 ;
			rate[11][16] = 0.446646 ; rate[11][17] = 0.023321 ;
			rate[11][18] = 0.068689 ; rate[11][19] = 0.144587 ;

			rate[12][13] = 0.173052 ; rate[12][14] = 0.010363 ;
			rate[12][15] = 0.090515 ; rate[12][16] = 0.184609 ;
			rate[12][17] = 0.022019 ; rate[12][18] = 0.073223 ;
			rate[12][19] = 0.307309 ;

			rate[13][14] = 0.042564 ; rate[13][15] = 0.138119 ;
			rate[13][16] = 0.085870 ; rate[13][17] = 0.128050 ;
			rate[13][18] = 0.898663 ; rate[13][19] = 0.247329 ;

			rate[14][15] = 0.430431 ; rate[14][16] = 0.207143 ;
			rate[14][17] = 0.014584 ; rate[14][18] = 0.032043 ;
			rate[14][19] = 0.129315 ;

			rate[15][16] = 1.767766 ; rate[15][17] = 0.035933 ;
			rate[15][18] = 0.121979 ; rate[15][19] = 0.127700 ;

			rate[16][17] = 0.020437 ; rate[16][18] = 0.094617 ;
			rate[16][19] = 0.740372 ;

			rate[17][18] = 0.124746 ; rate[17][19] = 0.022134 ;

			rate[18][19] = 0.125733 ;
		}
		else if(mod.is("wag")) {
			//pal
			f[0] = 0.0866;
			f[1] = 0.0440;
			f[2] = 0.0391;
			f[3] = 0.0570;
			f[4] = 0.0193;
			f[5] = 0.0367;
			f[6] = 0.0581;
			f[7] = 0.0833;
			f[8] = 0.0244;
			f[9] = 0.0485;
			f[10] = 0.0862;
			f[11] = 0.0620;
			f[12] = 0.0195;
			f[13] = 0.0384;
			f[14] = 0.0458;
			f[15] = 0.0695;
			f[16] = 0.0610;
			f[17] = 0.0144;
			f[18] = 0.0353;
			f[19] = 0.0709;
			
			rate[0][1] = 0.610810; rate[0][2] = 0.569079;
			rate[0][3] = 0.821500; rate[0][4] = 1.141050;
			rate[0][5] = 1.011980; rate[0][6] = 1.756410;
			rate[0][7] = 1.572160; rate[0][8] = 0.354813;
			rate[0][9] = 0.219023; rate[0][10] = 0.443935;
			rate[0][11] = 1.005440; rate[0][12] = 0.989475;
			rate[0][13] = 0.233492; rate[0][14] = 1.594890;
			rate[0][15] = 3.733380; rate[0][16] = 2.349220;
			rate[0][17] = 0.125227; rate[0][18] = 0.268987;
			rate[0][19] = 2.221870;

			rate[1][2] = 0.711690; rate[1][3] = 0.165074;
			rate[1][4] = 0.585809; rate[1][5] = 3.360330;
			rate[1][6] = 0.488649; rate[1][7] = 0.650469;
			rate[1][8] = 2.362040; rate[1][9] = 0.206722;
			rate[1][10] = 0.551450; rate[1][11] = 5.925170;
			rate[1][12] = 0.758446; rate[1][13] = 0.116821;
			rate[1][14] = 0.753467; rate[1][15] = 1.357640;
			rate[1][16] = 0.613776; rate[1][17] = 1.294610;
			rate[1][18] = 0.423612; rate[1][19] = 0.280336;

			rate[2][3] = 6.013660; rate[2][4] = 0.296524;
			rate[2][5] = 1.716740; rate[2][6] = 1.056790;
			rate[2][7] = 1.253910; rate[2][8] = 4.378930;
			rate[2][9] = 0.615636; rate[2][10] = 0.147156;
			rate[2][11] = 3.334390; rate[2][12] = 0.224747;
			rate[2][13] = 0.110793; rate[2][14] = 0.217538;
			rate[2][15] = 4.394450; rate[2][16] = 2.257930;
			rate[2][17] = 0.078463; rate[2][18] = 1.208560;
			rate[2][19] = 0.221176;

			rate[3][4] = 0.033379; rate[3][5] = 0.691268;
			rate[3][6] = 6.833400; rate[3][7] = 0.961142;
			rate[3][8] = 1.032910; rate[3][9] = 0.043523;
			rate[3][10] = 0.093930; rate[3][11] = 0.533362;
			rate[3][12] = 0.116813; rate[3][13] = 0.052004;
			rate[3][14] = 0.472601; rate[3][15] = 1.192810;
			rate[3][16] = 0.417372; rate[3][17] = 0.146348;
			rate[3][18] = 0.363243; rate[3][19] = 0.169417;

			rate[4][5] = 0.109261; rate[4][6] = 0.023920;
			rate[4][7] = 0.341086; rate[4][8] = 0.275403;
			rate[4][9] = 0.189890; rate[4][10] = 0.428414;
			rate[4][11] = 0.083649; rate[4][12] = 0.437393;
			rate[4][13] = 0.441300; rate[4][14] = 0.122303;
			rate[4][15] = 1.560590; rate[4][16] = 0.570186;
			rate[4][17] = 0.795736; rate[4][18] = 0.604634;
			rate[4][19] = 1.114570;

			rate[5][6] = 6.048790; rate[5][7] = 0.366510;
			rate[5][8] = 4.749460; rate[5][9] = 0.131046;
			rate[5][10] = 0.964886; rate[5][11] = 4.308310;
			rate[5][12] = 1.705070; rate[5][13] = 0.110744;
			rate[5][14] = 1.036370; rate[5][15] = 1.141210;
			rate[5][16] = 0.954144; rate[5][17] = 0.243615;
			rate[5][18] = 0.252457; rate[5][19] = 0.333890;

			rate[6][7] = 0.630832; rate[6][8] = 0.635025;
			rate[6][9] = 0.141320; rate[6][10] = 0.172579;
			rate[6][11] = 2.867580; rate[6][12] = 0.353912;
			rate[6][13] = 0.092310; rate[6][14] = 0.755791;
			rate[6][15] = 0.782467; rate[6][16] = 0.914814;
			rate[6][17] = 0.172682; rate[6][18] = 0.217549;
			rate[6][19] = 0.655045;

			rate[7][8] = 0.276379; rate[7][9] = 0.034151;
			rate[7][10] = 0.068651; rate[7][11] = 0.415992;
			rate[7][12] = 0.194220; rate[7][13] = 0.055288;
			rate[7][14] = 0.273149; rate[7][15] = 1.486700;
			rate[7][16] = 0.251477; rate[7][17] = 0.374321;
			rate[7][18] = 0.114187; rate[7][19] = 0.209108;

			rate[8][9] = 0.152215; rate[8][10] = 0.555096;
			rate[8][11] = 0.992083; rate[8][12] = 0.450867;
			rate[8][13] = 0.756080; rate[8][14] = 0.771387;
			rate[8][15] = 0.822459; rate[8][16] = 0.525511;
			rate[8][17] = 0.289998; rate[8][18] = 4.290350;
			rate[8][19] = 0.131869;

			rate[9][10] = 3.517820; rate[9][11] = 0.360574;
			rate[9][12] = 4.714220; rate[9][13] = 1.177640;
			rate[9][14] = 0.111502; rate[9][15] = 0.353443;
			rate[9][16] = 1.615050; rate[9][17] = 0.234326;
			rate[9][18] = 0.468951; rate[9][19] = 8.659740;

			rate[10][11] = 0.287583; rate[10][12] = 5.375250;
			rate[10][13] = 2.348200; rate[10][14] = 0.462018;
			rate[10][15] = 0.382421; rate[10][16] = 0.364222;
			rate[10][17] = 0.740259; rate[10][18] = 0.443205;
			rate[10][19] = 1.997370;

			rate[11][12] = 1.032220; rate[11][13] = 0.098843;
			rate[11][14] = 0.619503; rate[11][15] = 1.073780;
			rate[11][16] = 1.537920; rate[11][17] = 0.152232;
			rate[11][18] = 0.147411; rate[11][19] = 0.342012;

			rate[12][13] = 1.320870; rate[12][14] = 0.194864;
			rate[12][15] = 0.556353; rate[12][16] = 1.681970;
			rate[12][17] = 0.570369; rate[12][18] = 0.473810;
			rate[12][19] = 2.282020;

			rate[13][14] = 0.179896; rate[13][15] = 0.606814;
			rate[13][16] = 0.191467; rate[13][17] = 1.699780;
			rate[13][18] = 7.154480; rate[13][19] = 0.725096;

			rate[14][15] = 1.786490; rate[14][16] = 0.885349;
			rate[14][17] = 0.156619; rate[14][18] = 0.239607;
			rate[14][19] = 0.351250;

			rate[15][16] = 4.847130; rate[15][17] = 0.578784;
			rate[15][18] = 0.872519; rate[15][19] = 0.258861;

			rate[16][17] = 0.126678; rate[16][18] = 0.325490;
			rate[16][19] = 1.547670;

			rate[17][18] = 2.763540; rate[17][19] = 0.409817;

			rate[18][19] = 0.347826;
		}
		else if(mod.is("dcmut")) {
			//multiphyl
			f[ 0] = 0.087127; f[ 1] = 0.040904; f[ 2] = 0.040432; f[ 3] = 0.046872;
			f[ 4] = 0.033474; f[ 5] = 0.038255; f[ 6] = 0.049530; f[ 7] = 0.088612;
			f[ 8] = 0.033619; f[ 9] = 0.036886; f[10] = 0.085357; f[11] = 0.080481;
			f[12] = 0.014753; f[13] = 0.039772; f[14] = 0.050680; f[15] = 0.069577;
			f[16] = 0.058542; f[17] = 0.010494; f[18] = 0.029916; f[19] = 0.064718;
			
			rate[ 0 ][ 1 ] = 0.267828;
			rate[ 0 ][ 2 ] = 0.984474; rate[ 1 ][ 2 ] = 0.327059;
			rate[ 0 ][ 3 ] = 1.199805; rate[ 1 ][ 3 ] = 0.000000; rate[ 2 ][ 3 ] = 8.931515;
			rate[ 0 ][ 4 ] = 0.360016; rate[ 1 ][ 4 ] = 0.232374; rate[ 2 ][ 4 ] = 0.000000; rate[ 3 ][ 4 ] = 0.000000;
			rate[ 0 ][ 5 ] = 0.887753; rate[ 1 ][ 5 ] = 2.439939; rate[ 2 ][ 5 ] = 1.028509; rate[ 3 ][ 5 ] = 1.348551; rate[ 4 ][ 5 ] = 0.000000;
			rate[ 0 ][ 6 ] = 1.961167; rate[ 1 ][ 6 ] = 0.000000; rate[ 2 ][ 6 ] = 1.493409; rate[ 3 ][ 6 ] = 11.388659; rate[ 4 ][ 6 ] = 0.000000; rate[ 5 ][ 6 ] = 7.086022;
			rate[ 0 ][ 7 ] = 2.386111; rate[ 1 ][ 7 ] = 0.087791; rate[ 2 ][ 7 ] = 1.385352; rate[ 3 ][ 7 ] = 1.240981; rate[ 4 ][ 7 ] = 0.107278; rate[ 5 ][ 7 ] = 0.281581; rate[ 6 ][ 7 ] = 0.811907;
			rate[ 0 ][ 8 ] = 0.228116; rate[ 1 ][ 8 ] = 2.383148; rate[ 2 ][ 8 ] = 5.290024; rate[ 3 ][ 8 ] = 0.868241; rate[ 4 ][ 8 ] = 0.282729; rate[ 5 ][ 8 ] = 6.011613; rate[ 6 ][ 8 ] = 0.439469; rate[ 7 ][ 8 ] = 0.106802;
			rate[ 0 ][ 9 ] = 0.653416; rate[ 1 ][ 9 ] = 0.632629; rate[ 2 ][ 9 ] = 0.768024; rate[ 3 ][ 9 ] = 0.239248; rate[ 4 ][ 9 ] = 0.438074; rate[ 5 ][ 9 ] = 0.180393; rate[ 6 ][ 9 ] = 0.609526; rate[ 7 ][ 9 ] = 0.000000; rate[ 8 ][ 9 ] = 0.076981;
			rate[ 0 ][ 10 ] = 0.406431; rate[ 1 ][ 10 ] = 0.154924; rate[ 2 ][ 10 ] = 0.341113; rate[ 3 ][ 10 ] = 0.000000; rate[ 4 ][ 10 ] = 0.000000; rate[ 5 ][ 10 ] = 0.730772; rate[ 6 ][ 10 ] = 0.112880; rate[ 7 ][ 10 ] = 0.071514; rate[ 8 ][ 10 ] = 0.443504; rate[ 9 ][ 10 ] = 2.556685;
			rate[ 0 ][ 11 ] = 0.258635; rate[ 1 ][ 11 ] = 4.610124; rate[ 2 ][ 11 ] = 3.148371; rate[ 3 ][ 11 ] = 0.716913; rate[ 4 ][ 11 ] = 0.000000; rate[ 5 ][ 11 ] = 1.519078; rate[ 6 ][ 11 ] = 0.830078; rate[ 7 ][ 11 ] = 0.267683; rate[ 8 ][ 11 ] = 0.270475; rate[ 9 ][ 11 ] = 0.460857; rate[ 10 ][ 11 ] = 0.180629;
			rate[ 0 ][ 12 ] = 0.717840; rate[ 1 ][ 12 ] = 0.896321; rate[ 2 ][ 12 ] = 0.000000; rate[ 3 ][ 12 ] = 0.000000; rate[ 4 ][ 12 ] = 0.000000; rate[ 5 ][ 12 ] = 1.127499; rate[ 6 ][ 12 ] = 0.304803; rate[ 7 ][ 12 ] = 0.170372; rate[ 8 ][ 12 ] = 0.000000; rate[ 9 ][ 12 ] = 3.332732; rate[ 10 ][ 12 ] = 5.230115; rate[ 11 ][ 12 ] = 2.411739;
			rate[ 0 ][ 13 ] = 0.183641; rate[ 1 ][ 13 ] = 0.136906; rate[ 2 ][ 13 ] = 0.138503; rate[ 3 ][ 13 ] = 0.000000; rate[ 4 ][ 13 ] = 0.000000; rate[ 5 ][ 13 ] = 0.000000; rate[ 6 ][ 13 ] = 0.000000; rate[ 7 ][ 13 ] = 0.153478; rate[ 8 ][ 13 ] = 0.475927; rate[ 9 ][ 13 ] = 1.951951; rate[ 10 ][ 13 ] = 1.565160; rate[ 11 ][ 13 ] = 0.000000; rate[ 12 ][ 13 ] = 0.921860;
			rate[ 0 ][ 14 ] = 2.485920; rate[ 1 ][ 14 ] = 1.028313; rate[ 2 ][ 14 ] = 0.419244; rate[ 3 ][ 14 ] = 0.133940; rate[ 4 ][ 14 ] = 0.187550; rate[ 5 ][ 14 ] = 1.526188; rate[ 6 ][ 14 ] = 0.507003; rate[ 7 ][ 14 ] = 0.347153; rate[ 8 ][ 14 ] = 0.933709; rate[ 9 ][ 14 ] = 0.119152; rate[ 10 ][ 14 ] = 0.316258; rate[ 11 ][ 14 ] = 0.335419; rate[ 12 ][ 14 ] = 0.170205; rate[ 13 ][ 14 ] = 0.110506;
			rate[ 0 ][ 15 ] = 4.051870; rate[ 1 ][ 15 ] = 1.531590; rate[ 2 ][ 15 ] = 4.885892; rate[ 3 ][ 15 ] = 0.956097; rate[ 4 ][ 15 ] = 1.598356; rate[ 5 ][ 15 ] = 0.561828; rate[ 6 ][ 15 ] = 0.793999; rate[ 7 ][ 15 ] = 2.322243; rate[ 8 ][ 15 ] = 0.353643; rate[ 9 ][ 15 ] = 0.247955; rate[ 10 ][ 15 ] = 0.171432; rate[ 11 ][ 15 ] = 0.954557; rate[ 12 ][ 15 ] = 0.619951; rate[ 13 ][ 15 ] = 0.459901; rate[ 14 ][ 15 ] = 2.427202;
			rate[ 0 ][ 16 ] = 3.680365; rate[ 1 ][ 16 ] = 0.265745; rate[ 2 ][ 16 ] = 2.271697; rate[ 3 ][ 16 ] = 0.660930; rate[ 4 ][ 16 ] = 0.162366; rate[ 5 ][ 16 ] = 0.525651; rate[ 6 ][ 16 ] = 0.340156; rate[ 7 ][ 16 ] = 0.306662; rate[ 8 ][ 16 ] = 0.226333; rate[ 9 ][ 16 ] = 1.900739; rate[ 10 ][ 16 ] = 0.331090; rate[ 11 ][ 16 ] = 1.350599; rate[ 12 ][ 16 ] = 1.031534; rate[ 13 ][ 16 ] = 0.136655; rate[ 14 ][ 16 ] = 0.782857; rate[ 15 ][ 16 ] = 5.436674;
			rate[ 0 ][ 17 ] = 0.000000; rate[ 1 ][ 17 ] = 2.001375; rate[ 2 ][ 17 ] = 0.224968; rate[ 3 ][ 17 ] = 0.000000; rate[ 4 ][ 17 ] = 0.000000; rate[ 5 ][ 17 ] = 0.000000; rate[ 6 ][ 17 ] = 0.000000; rate[ 7 ][ 17 ] = 0.000000; rate[ 8 ][ 17 ] = 0.270564; rate[ 9 ][ 17 ] = 0.000000; rate[ 10 ][ 17 ] = 0.461776; rate[ 11 ][ 17 ] = 0.000000; rate[ 12 ][ 17 ] = 0.000000; rate[ 13 ][ 17 ] = 0.762354; rate[ 14 ][ 17 ] = 0.000000; rate[ 15 ][ 17 ] = 0.740819; rate[ 16 ][ 17 ] = 0.000000;
			rate[ 0 ][ 18 ] = 0.244139; rate[ 1 ][ 18 ] = 0.078012; rate[ 2 ][ 18 ] = 0.946940; rate[ 3 ][ 18 ] = 0.000000; rate[ 4 ][ 18 ] = 0.953164; rate[ 5 ][ 18 ] = 0.000000; rate[ 6 ][ 18 ] = 0.214717; rate[ 7 ][ 18 ] = 0.000000; rate[ 8 ][ 18 ] = 1.265400; rate[ 9 ][ 18 ] = 0.374834; rate[ 10 ][ 18 ] = 0.286572; rate[ 11 ][ 18 ] = 0.132142; rate[ 12 ][ 18 ] = 0.000000; rate[ 13 ][ 18 ] = 6.952629; rate[ 14 ][ 18 ] = 0.000000; rate[ 15 ][ 18 ] = 0.336289; rate[ 16 ][ 18 ] = 0.417839; rate[ 17 ][ 18 ] = 0.608070;
			rate[ 0 ][ 19 ] = 2.059564; rate[ 1 ][ 19 ] = 0.240368; rate[ 2 ][ 19 ] = 0.158067; rate[ 3 ][ 19 ] = 0.178316; rate[ 4 ][ 19 ] = 0.484678; rate[ 5 ][ 19 ] = 0.346983; rate[ 6 ][ 19 ] = 0.367250; rate[ 7 ][ 19 ] = 0.538165; rate[ 8 ][ 19 ] = 0.438715; rate[ 9 ][ 19 ] = 8.810038; rate[ 10 ][ 19 ] = 1.745156; rate[ 11 ][ 19 ] = 0.103850; rate[ 12 ][ 19 ] = 2.565955; rate[ 13 ][ 19 ] = 0.123606; rate[ 14 ][ 19 ] = 0.485026; rate[ 15 ][ 19 ] = 0.303836; rate[ 16 ][ 19 ] = 1.561997; rate[ 17 ][ 19 ] = 0.000000; rate[ 18 ][ 19 ] = 0.279379;
		}
		else if(mod.is("gtr")) {
			
		}
		else if(mod.is("rtrev")) {
			//multiphyl
			f[0]= 0.0646;           f[1]= 0.0453;           f[2]= 0.0376;           f[3]= 0.0422;
			f[4]= 0.0114;           f[5]= 0.0606;           f[6]= 0.0607;           f[7]= 0.0639;
			f[8]= 0.0273;           f[9]= 0.0679;           f[10]= 0.1018;          f[11]= 0.0751;
			f[12]= 0.015;           f[13]= 0.0287;          f[14]= 0.0681;          f[15]= 0.0488;
			f[16]= 0.0622;          f[17]= 0.0251;          f[18]= 0.0318;          f[19]= 0.0619;
			
			rate[ 0 ][ 1 ] = 33;
			rate[ 0 ][ 2 ] = 50; rate[ 1 ][ 2 ] = 34;
			rate[ 0 ][ 3 ] = 9; rate[ 1 ][ 3 ] = 29; rate[ 2 ][ 3 ] = 383;
			rate[ 0 ][ 4 ] = 438; rate[ 1 ][ 4 ] = 91; rate[ 2 ][ 4 ] = 127; rate[ 3 ][ 4 ] = 0;
			rate[ 0 ][ 5 ] = 31; rate[ 1 ][ 5 ] = 220; rate[ 2 ][ 5 ] = 235; rate[ 3 ][ 5 ] = 77; rate[ 4 ][ 5 ] = 69;
			rate[ 0 ][ 6 ] = 80; rate[ 1 ][ 6 ] = 9; rate[ 2 ][ 6 ] = 78; rate[ 3 ][ 6 ] = 541; rate[ 4 ][ 6 ] = 0; rate[ 5 ][ 6 ] = 371;
			rate[ 0 ][ 7 ] = 134; rate[ 1 ][ 7 ] = 40; rate[ 2 ][ 7 ] = 93; rate[ 3 ][ 7 ] = 60; rate[ 4 ][ 7 ] = 47; rate[ 5 ][ 7 ] = 17; rate[ 6 ][ 7 ] = 69;
			rate[ 0 ][ 8 ] = 29; rate[ 1 ][ 8 ] = 89; rate[ 2 ][ 8 ] = 319; rate[ 3 ][ 8 ] = 90; rate[ 4 ][ 8 ] = 123; rate[ 5 ][ 8 ] = 386; rate[ 6 ][ 8 ] = 33; rate[ 7 ][ 8 ] = 67;
			rate[ 0 ][ 9 ] = 0; rate[ 1 ][ 9 ] = 23; rate[ 2 ][ 9 ] = 34; rate[ 3 ][ 9 ] = 0; rate[ 4 ][ 9 ] = 103; rate[ 5 ][ 9 ] = 32; rate[ 6 ][ 9 ] = 0; rate[ 7 ][ 9 ] = 0; rate[ 8 ][ 9 ] = 33;
			rate[ 0 ][ 10 ] = 44; rate[ 1 ][ 10 ] = 17; rate[ 2 ][ 10 ] = 14; rate[ 3 ][ 10 ] = 4; rate[ 4 ][ 10 ] = 109; rate[ 5 ][ 10 ] = 53; rate[ 6 ][ 10 ] = 20; rate[ 7 ][ 10 ] = 2; rate[ 8 ][ 10 ] = 50; rate[ 9 ][ 10 ] = 384;
			rate[ 0 ][ 11 ] = 37; rate[ 1 ][ 11 ] = 592; rate[ 2 ][ 11 ] = 122; rate[ 3 ][ 11 ] = 19; rate[ 4 ][ 11 ] = 15; rate[ 5 ][ 11 ] = 308; rate[ 6 ][ 11 ] = 140; rate[ 7 ][ 11 ] = 29; rate[ 8 ][ 11 ] = 75; rate[ 9 ][ 11 ] = 33; rate[ 10 ][ 11 ] = 22;
			rate[ 0 ][ 12 ] = 234; rate[ 1 ][ 12 ] = 56; rate[ 2 ][ 12 ] = 0; rate[ 3 ][ 12 ] = 0; rate[ 4 ][ 12 ] = 155; rate[ 5 ][ 12 ] = 157; rate[ 6 ][ 12 ] = 0; rate[ 7 ][ 12 ] = 36; rate[ 8 ][ 12 ] = 115; rate[ 9 ][ 12 ] = 374; rate[ 10 ][ 12 ] = 580; rate[ 11 ][ 12 ] = 133;
			rate[ 0 ][ 13 ] = 0; rate[ 1 ][ 13 ] = 6; rate[ 2 ][ 13 ] = 48; rate[ 3 ][ 13 ] = 0; rate[ 4 ][ 13 ] = 69; rate[ 5 ][ 13 ] = 0; rate[ 6 ][ 13 ] = 0; rate[ 7 ][ 13 ] = 6; rate[ 8 ][ 13 ] = 140; rate[ 9 ][ 13 ] = 63; rate[ 10 ][ 13 ] = 178; rate[ 11 ][ 13 ] = 13; rate[ 12 ][ 13 ] = 246;
			rate[ 0 ][ 14 ] = 96; rate[ 1 ][ 14 ] = 23; rate[ 2 ][ 14 ] = 32; rate[ 3 ][ 14 ] = 54; rate[ 4 ][ 14 ] = 0; rate[ 5 ][ 14 ] = 67; rate[ 6 ][ 14 ] = 51; rate[ 7 ][ 14 ] = 16; rate[ 8 ][ 14 ] = 43; rate[ 9 ][ 14 ] = 9; rate[ 10 ][ 14 ] = 21; rate[ 11 ][ 14 ] = 42; rate[ 12 ][ 14 ] = 0; rate[ 13 ][ 14 ] = 10;
			rate[ 0 ][ 15 ] = 459; rate[ 1 ][ 15 ] = 101; rate[ 2 ][ 15 ] = 293; rate[ 3 ][ 15 ] = 135; rate[ 4 ][ 15 ] = 74; rate[ 5 ][ 15 ] = 224; rate[ 6 ][ 15 ] = 94; rate[ 7 ][ 15 ] = 151; rate[ 8 ][ 15 ] = 182; rate[ 9 ][ 15 ] = 3; rate[ 10 ][ 15 ] = 23; rate[ 11 ][ 15 ] = 76; rate[ 12 ][ 15 ] = 0; rate[ 13 ][ 15 ] = 19; rate[ 14 ][ 15 ] = 133;
			rate[ 0 ][ 16 ] = 257; rate[ 1 ][ 16 ] = 63; rate[ 2 ][ 16 ] = 147; rate[ 3 ][ 16 ] = 54; rate[ 4 ][ 16 ] = 116; rate[ 5 ][ 16 ] = 145; rate[ 6 ][ 16 ] = 81; rate[ 7 ][ 16 ] = 6; rate[ 8 ][ 16 ] = 48; rate[ 9 ][ 16 ] = 71; rate[ 10 ][ 16 ] = 24; rate[ 11 ][ 16 ] = 109; rate[ 12 ][ 16 ] = 130; rate[ 13 ][ 16 ] = 68; rate[ 14 ][ 16 ] = 61; rate[ 15 ][ 16 ] = 670;
			rate[ 0 ][ 17 ] = 4; rate[ 1 ][ 17 ] = 12; rate[ 2 ][ 17 ] = 15; rate[ 3 ][ 17 ] = 0; rate[ 4 ][ 17 ] = 54; rate[ 5 ][ 17 ] = 9; rate[ 6 ][ 17 ] = 16; rate[ 7 ][ 17 ] = 22; rate[ 8 ][ 17 ] = 47; rate[ 9 ][ 17 ] = 38; rate[ 10 ][ 17 ] = 46; rate[ 11 ][ 17 ] = 5; rate[ 12 ][ 17 ] = 110; rate[ 13 ][ 17 ] = 181; rate[ 14 ][ 17 ] = 8; rate[ 15 ][ 17 ] = 13; rate[ 16 ][ 17 ] = 0;
			rate[ 0 ][ 18 ] = 54; rate[ 1 ][ 18 ] = 46; rate[ 2 ][ 18 ] = 27; rate[ 3 ][ 18 ] = 0; rate[ 4 ][ 18 ] = 130; rate[ 5 ][ 18 ] = 44; rate[ 6 ][ 18 ] = 0; rate[ 7 ][ 18 ] = 20; rate[ 8 ][ 18 ] = 306; rate[ 9 ][ 18 ] = 25; rate[ 10 ][ 18 ] = 63; rate[ 11 ][ 18 ] = 0; rate[ 12 ][ 18 ] = 73; rate[ 13 ][ 18 ] = 1016; rate[ 14 ][ 18 ] = 13; rate[ 15 ][ 18 ] = 30; rate[ 16 ][ 18 ] = 33; rate[ 17 ][ 18 ] = 175;
			rate[ 0 ][ 19 ] = 196; rate[ 1 ][ 19 ] = 28; rate[ 2 ][ 19 ] = 20; rate[ 3 ][ 19 ] = 5; rate[ 4 ][ 19 ] = 294; rate[ 5 ][ 19 ] = 35; rate[ 6 ][ 19 ] = 34; rate[ 7 ][ 19 ] = 2; rate[ 8 ][ 19 ] = 0; rate[ 9 ][ 19 ] = 1047; rate[ 10 ][ 19 ] = 111; rate[ 11 ][ 19 ] = 18; rate[ 12 ][ 19 ] = 235; rate[ 13 ][ 19 ] = 91; rate[ 14 ][ 19 ] = 24; rate[ 15 ][ 19 ] = 38; rate[ 16 ][ 19 ] = 195; rate[ 17 ][ 19 ] = 25; rate[ 18 ][ 19 ] = 58;
		}
		else if(mod.is("cprev")) {
			//pal
			f[0] = 0.076;
			f[1] = 0.062;
			f[2] = 0.041;
			f[3] = 0.037;
			f[4] = 0.009;
			f[5] = 0.038;
			f[6] = 0.049;
			f[7] = 0.084;
			f[8] = 0.025;
			f[9] = 0.081;
			f[10] = 0.101;
			f[11] = 0.050;
			f[12] = 0.022;
			f[13] = 0.051;
			f[14] = 0.043;
			f[15] = 0.062;
			f[16] = 0.054;
			f[17] = 0.018;
			f[18] = 0.031;
			f[19] = 0.066;
			
			rate[0][1] = 105; rate[0][2] = 227;
			rate[0][3] = 175; rate[0][4] = 669;
			rate[0][5] = 157; rate[0][6] = 499;
			rate[0][7] = 665; rate[0][8] = 66;
			rate[0][9] = 145; rate[0][10] = 197;
			rate[0][11] = 236; rate[0][12] = 185;
			rate[0][13] = 68; rate[0][14] = 490;
			rate[0][15] = 2440; rate[0][16] = 1340;
			rate[0][17] = 14; rate[0][18] = 56;
			rate[0][19] = 968;

			rate[1][2] = 357; rate[1][3] = 43;
			rate[1][4] = 823; rate[1][5] = 1745;
			rate[1][6] = 152; rate[1][7] = 243;
			rate[1][8] = 715; rate[1][9] = 136;
			rate[1][10] = 203; rate[1][11] = 4482;
			rate[1][12] = 125; rate[1][13] = 53;
			rate[1][14] = 87; rate[1][15] = 385;
			rate[1][16] = 314; rate[1][17] = 230;
			rate[1][18] = 323; rate[1][19] = 92;

			rate[2][3] = 4435; rate[2][4] = 538;
			rate[2][5] = 768; rate[2][6] = 1055;
			rate[2][7] = 653; rate[2][8] = 1405;
			rate[2][9] = 168; rate[2][10] = 113;
			rate[2][11] = 2430; rate[2][12] = 61;
			rate[2][13] = 97; rate[2][14] = 173;
			rate[2][15] = 2085; rate[2][16] = 1393;
			rate[2][17] = 40; rate[2][18] = 754;
			rate[2][19] = 83;

			rate[3][4] = 10; rate[3][5] = 400;
			rate[3][6] = 3691; rate[3][7] = 431;
			rate[3][8] = 331; rate[3][9] = 10;
			rate[3][10] = 10; rate[3][11] = 412;
			rate[3][12] = 47; rate[3][13] = 22;
			rate[3][14] = 170; rate[3][15] = 590;
			rate[3][16] = 266; rate[3][17] = 18;
			rate[3][18] = 281; rate[3][19] = 75;

			rate[4][5] = 10; rate[4][6] = 10;
			rate[4][7] = 303; rate[4][8] = 441;
			rate[4][9] = 280; rate[4][10] = 396;
			rate[4][11] = 48; rate[4][12] = 159;
			rate[4][13] = 726; rate[4][14] = 285;
			rate[4][15] = 2331; rate[4][16] = 576;
			rate[4][17] = 435; rate[4][18] = 1466;
			rate[4][19] = 592;

			rate[5][6] = 3122; rate[5][7] = 133;
			rate[5][8] = 1269; rate[5][9] = 92;
			rate[5][10] = 286; rate[5][11] = 3313;
			rate[5][12] = 202; rate[5][13] = 10;
			rate[5][14] = 323; rate[5][15] = 396;
			rate[5][16] = 241; rate[5][17] = 53;
			rate[5][18] = 391; rate[5][19] = 54;

			rate[6][7] = 379; rate[6][8] = 162;
			rate[6][9] = 148; rate[6][10] = 82;
			rate[6][11] = 2629; rate[6][12] = 113;
			rate[6][13] = 145; rate[6][14] = 185;
			rate[6][15] = 568; rate[6][16] = 369;
			rate[6][17] = 63; rate[6][18] = 142;
			rate[6][19] = 200;

			rate[7][8] = 19; rate[7][9] = 40;
			rate[7][10] = 20; rate[7][11] = 263;
			rate[7][12] = 21; rate[7][13] = 25;
			rate[7][14] = 28; rate[7][15] = 691;
			rate[7][16] = 92; rate[7][17] = 82;
			rate[7][18] = 10; rate[7][19] = 91;

			rate[8][9] = 29; rate[8][10] = 66;
			rate[8][11] = 305; rate[8][12] = 10;
			rate[8][13] = 127; rate[8][14] = 152;
			rate[8][15] = 303; rate[8][16] = 32;
			rate[8][17] = 69; rate[8][18] = 1971;
			rate[8][19] = 25;

			rate[9][10] = 1745; rate[9][11] = 345;
			rate[9][12] = 1772; rate[9][13] = 454;
			rate[9][14] = 117; rate[9][15] = 216;
			rate[9][16] = 1040; rate[9][17] = 42;
			rate[9][18] = 89; rate[9][19] = 4797;

			rate[10][11] = 218; rate[10][12] = 1351;
			rate[10][13] = 1268; rate[10][14] = 219;
			rate[10][15] = 516; rate[10][16] = 156;
			rate[10][17] = 159; rate[10][18] = 189;
			rate[10][19] = 865;

			rate[11][12] = 193; rate[11][13] = 72;
			rate[11][14] = 302; rate[11][15] = 868;
			rate[11][16] = 918; rate[11][17] = 10;
			rate[11][18] = 247; rate[11][19] = 249;

			rate[12][13] = 327; rate[12][14] = 100;
			rate[12][15] = 93; rate[12][16] = 645;
			rate[12][17] = 86; rate[12][18] = 215;
			rate[12][19] = 475;

			rate[13][14] = 43; rate[13][15] = 487;
			rate[13][16] = 148; rate[13][17] = 468;
			rate[13][18] = 2370; rate[13][19] = 317;

			rate[14][15] = 1202; rate[14][16] = 260;
			rate[14][17] = 49; rate[14][18] = 97;
			rate[14][19] = 122;

			rate[15][16] = 2151; rate[15][17] = 73;
			rate[15][18] = 522; rate[15][19] = 167;

			rate[16][17] = 29; rate[16][18] = 71;
			rate[16][19] = 760;

			rate[17][18] = 346; rate[17][19] = 10;

			rate[18][19] = 119;
			
		}
		else if(mod.is("mtmam")) {
			//multiphyl
			f[0]= 0.0692;  f[1]=  0.0184;  f[2]= 0.04;    f[3]= 0.0186;
			f[4]= 0.0065;  f[5]=  0.0238;  f[6]= 0.0236;  f[7]= 0.0557;
			f[8]= 0.0277;  f[9]=  0.0905;  f[10]=0.1675;  f[11]= 0.0221;
			f[12]=0.0561;  f[13]= 0.0611;  f[14]=0.0536;  f[15]= 0.0725;
			f[16]=0.087;   f[17]= 0.0293;  f[18]=0.034;   f[19]= 0.0428;
			
			rate[ 0 ][ 1 ] = 32;
			rate[ 0 ][ 2 ] = 2; rate[ 1 ][ 2 ] = 4;
			rate[ 0 ][ 3 ] = 11; rate[ 1 ][ 3 ] = 0; rate[ 2 ][ 3 ] = 864;
			rate[ 0 ][ 4 ] = 0; rate[ 1 ][ 4 ] = 186; rate[ 2 ][ 4 ] = 0; rate[ 3 ][ 4 ] = 0;
			rate[ 0 ][ 5 ] = 0; rate[ 1 ][ 5 ] = 246; rate[ 2 ][ 5 ] = 8; rate[ 3 ][ 5 ] = 49; rate[ 4 ][ 5 ] = 0;
			rate[ 0 ][ 6 ] = 0; rate[ 1 ][ 6 ] = 0; rate[ 2 ][ 6 ] = 0; rate[ 3 ][ 6 ] = 569; rate[ 4 ][ 6 ] = 0; rate[ 5 ][ 6 ] = 274;
			rate[ 0 ][ 7 ] = 78; rate[ 1 ][ 7 ] = 18; rate[ 2 ][ 7 ] = 47; rate[ 3 ][ 7 ] = 79; rate[ 4 ][ 7 ] = 0; rate[ 5 ][ 7 ] = 0; rate[ 6 ][ 7 ] = 22;
			rate[ 0 ][ 8 ] = 8; rate[ 1 ][ 8 ] = 232; rate[ 2 ][ 8 ] = 458; rate[ 3 ][ 8 ] = 11; rate[ 4 ][ 8 ] = 305; rate[ 5 ][ 8 ] = 550; rate[ 6 ][ 8 ] = 22; rate[ 7 ][ 8 ] = 0;
			rate[ 0 ][ 9 ] = 75; rate[ 1 ][ 9 ] = 0; rate[ 2 ][ 9 ] = 19; rate[ 3 ][ 9 ] = 0; rate[ 4 ][ 9 ] = 41; rate[ 5 ][ 9 ] = 0; rate[ 6 ][ 9 ] = 0; rate[ 7 ][ 9 ] = 0; rate[ 8 ][ 9 ] = 0;
			rate[ 0 ][ 10 ] = 21; rate[ 1 ][ 10 ] = 6; rate[ 2 ][ 10 ] = 0; rate[ 3 ][ 10 ] = 0; rate[ 4 ][ 10 ] = 27; rate[ 5 ][ 10 ] = 20; rate[ 6 ][ 10 ] = 0; rate[ 7 ][ 10 ] = 0; rate[ 8 ][ 10 ] = 26; rate[ 9 ][ 10 ] = 232;
			rate[ 0 ][ 11 ] = 0; rate[ 1 ][ 11 ] = 50; rate[ 2 ][ 11 ] = 408; rate[ 3 ][ 11 ] = 0; rate[ 4 ][ 11 ] = 0; rate[ 5 ][ 11 ] = 242; rate[ 6 ][ 11 ] = 215; rate[ 7 ][ 11 ] = 0; rate[ 8 ][ 11 ] = 0; rate[ 9 ][ 11 ] = 6; rate[ 10 ][ 11 ] = 4;
			rate[ 0 ][ 12 ] = 76; rate[ 1 ][ 12 ] = 0; rate[ 2 ][ 12 ] = 21; rate[ 3 ][ 12 ] = 0; rate[ 4 ][ 12 ] = 0; rate[ 5 ][ 12 ] = 22; rate[ 6 ][ 12 ] = 0; rate[ 7 ][ 12 ] = 0; rate[ 8 ][ 12 ] = 0; rate[ 9 ][ 12 ] = 378; rate[ 10 ][ 12 ] = 609; rate[ 11 ][ 12 ] = 59;
			rate[ 0 ][ 13 ] = 0; rate[ 1 ][ 13 ] = 0; rate[ 2 ][ 13 ] = 6; rate[ 3 ][ 13 ] = 5; rate[ 4 ][ 13 ] = 7; rate[ 5 ][ 13 ] = 0; rate[ 6 ][ 13 ] = 0; rate[ 7 ][ 13 ] = 0; rate[ 8 ][ 13 ] = 0; rate[ 9 ][ 13 ] = 57; rate[ 10 ][ 13 ] = 246; rate[ 11 ][ 13 ] = 0; rate[ 12 ][ 13 ] = 11;
			rate[ 0 ][ 14 ] = 53; rate[ 1 ][ 14 ] = 9; rate[ 2 ][ 14 ] = 33; rate[ 3 ][ 14 ] = 2; rate[ 4 ][ 14 ] = 0; rate[ 5 ][ 14 ] = 51; rate[ 6 ][ 14 ] = 0; rate[ 7 ][ 14 ] = 0; rate[ 8 ][ 14 ] = 53; rate[ 9 ][ 14 ] = 5; rate[ 10 ][ 14 ] = 43; rate[ 11 ][ 14 ] = 18; rate[ 12 ][ 14 ] = 0; rate[ 13 ][ 14 ] = 17;
			rate[ 0 ][ 15 ] = 342; rate[ 1 ][ 15 ] = 3; rate[ 2 ][ 15 ] = 446; rate[ 3 ][ 15 ] = 16; rate[ 4 ][ 15 ] = 347; rate[ 5 ][ 15 ] = 30; rate[ 6 ][ 15 ] = 21; rate[ 7 ][ 15 ] = 112; rate[ 8 ][ 15 ] = 20; rate[ 9 ][ 15 ] = 0; rate[ 10 ][ 15 ] = 74; rate[ 11 ][ 15 ] = 65; rate[ 12 ][ 15 ] = 47; rate[ 13 ][ 15 ] = 90; rate[ 14 ][ 15 ] = 202;
			rate[ 0 ][ 16 ] = 681; rate[ 1 ][ 16 ] = 0; rate[ 2 ][ 16 ] = 110; rate[ 3 ][ 16 ] = 0; rate[ 4 ][ 16 ] = 114; rate[ 5 ][ 16 ] = 0; rate[ 6 ][ 16 ] = 4; rate[ 7 ][ 16 ] = 0; rate[ 8 ][ 16 ] = 1; rate[ 9 ][ 16 ] = 360; rate[ 10 ][ 16 ] = 34; rate[ 11 ][ 16 ] = 50; rate[ 12 ][ 16 ] = 691; rate[ 13 ][ 16 ] = 8; rate[ 14 ][ 16 ] = 78; rate[ 15 ][ 16 ] = 614;
			rate[ 0 ][ 17 ] = 5; rate[ 1 ][ 17 ] = 16; rate[ 2 ][ 17 ] = 6; rate[ 3 ][ 17 ] = 0; rate[ 4 ][ 17 ] = 65; rate[ 5 ][ 17 ] = 0; rate[ 6 ][ 17 ] = 0; rate[ 7 ][ 17 ] = 0; rate[ 8 ][ 17 ] = 0; rate[ 9 ][ 17 ] = 0; rate[ 10 ][ 17 ] = 12; rate[ 11 ][ 17 ] = 0; rate[ 12 ][ 17 ] = 13; rate[ 13 ][ 17 ] = 0; rate[ 14 ][ 17 ] = 7; rate[ 15 ][ 17 ] = 17; rate[ 16 ][ 17 ] = 0;
			rate[ 0 ][ 18 ] = 0; rate[ 1 ][ 18 ] = 0; rate[ 2 ][ 18 ] = 156; rate[ 3 ][ 18 ] = 0; rate[ 4 ][ 18 ] = 530; rate[ 5 ][ 18 ] = 54; rate[ 6 ][ 18 ] = 0; rate[ 7 ][ 18 ] = 1; rate[ 8 ][ 18 ] = 1525; rate[ 9 ][ 18 ] = 16; rate[ 10 ][ 18 ] = 25; rate[ 11 ][ 18 ] = 67; rate[ 12 ][ 18 ] = 0; rate[ 13 ][ 18 ] = 682; rate[ 14 ][ 18 ] = 8; rate[ 15 ][ 18 ] = 107; rate[ 16 ][ 18 ] = 0; rate[ 17 ][ 18 ] = 14;
			rate[ 0 ][ 19 ] = 398; rate[ 1 ][ 19 ] = 0; rate[ 2 ][ 19 ] = 0; rate[ 3 ][ 19 ] = 10; rate[ 4 ][ 19 ] = 0; rate[ 5 ][ 19 ] = 33; rate[ 6 ][ 19 ] = 20; rate[ 7 ][ 19 ] = 5; rate[ 8 ][ 19 ] = 0; rate[ 9 ][ 19 ] = 2220; rate[ 10 ][ 19 ] = 100; rate[ 11 ][ 19 ] = 0; rate[ 12 ][ 19 ] = 832; rate[ 13 ][ 19 ] = 6; rate[ 14 ][ 19 ] = 0; rate[ 15 ][ 19 ] = 0; rate[ 16 ][ 19 ] = 237; rate[ 17 ][ 19 ] = 0; rate[ 18 ][ 19 ] = 0;
		}
		else if(mod.is("mtart")) {
			//paml4
			f[0]= 0.054116; 
			f[1]= 0.018227; 
			f[2]= 0.039903;
			f[3]= 0.020160;
			f[4]= 0.009709;
			f[5]= 0.018781; 
			f[6]= 0.024289;
			f[7]= 0.068183;
			f[8]= 0.024518;
			f[9]= 0.092638; 
			f[10]= 0.148658;
			f[11]= 0.021718;
			f[12]= 0.061453;
			f[13]= 0.088668;
			f[14]= 0.041826;
			f[15]= 0.091030;
			f[16]= 0.049194;
			f[17]= 0.029786;
			f[18]= 0.039443; 
			f[19]= 0.057700; 
			
			rate[0][1]=0.2;
			rate[0][2]=0.2;	rate[1][2]=0.2;
			rate[0][3]=1;	rate[1][3]=4;	rate[2][3]=500;
			rate[0][4]=254;	rate[1][4]=36;	rate[2][4]=98;	rate[3][4]=11;
			rate[0][5]=0.2;	rate[1][5]=154;	rate[2][5]=262;	rate[3][5]=0.2;	rate[4][5]=0.2;
			rate[0][6]=0.2;	rate[1][6]=0.2;	rate[2][6]=183;	rate[3][6]=862;	rate[4][6]=0.2;	rate[5][6]=262;
			rate[0][7]=200;	rate[1][7]=0.2;	rate[2][7]=121;	rate[3][7]=12;	rate[4][7]=81;	rate[5][7]=3;	rate[6][7]=44;
			rate[0][8]=0.2;	rate[1][8]=41;	rate[2][8]=180;	rate[3][8]=0.2;	rate[4][8]=12;	rate[5][8]=314;	rate[6][8]=15;	rate[7][8]=0.2;
			rate[0][9]=26;	rate[1][9]=2;	rate[2][9]=21;	rate[3][9]=7;	rate[4][9]=63;	rate[5][9]=11;	rate[6][9]=7;	rate[7][9]=3;	rate[8][9]=0.2;
			rate[0][10]=4;	rate[1][10]=2;	rate[2][10]=13;	rate[3][10]=1;	rate[4][10]=79;	rate[5][10]=16;	rate[6][10]=2;	rate[7][10]=1;	rate[8][10]=6;	rate[9][10]=515;
			rate[0][11]=0.2;rate[1][11]=209;rate[2][11]=467;rate[3][11]=2;	rate[4][11]=0.2;rate[5][11]=349;rate[6][11]=106;rate[7][11]=0.2;rate[8][11]=0.2;rate[9][11]=3;		rate[10][11]=4;
			rate[0][12]=121;rate[1][12]=5;	rate[2][12]=79;	rate[3][12]=0.2;rate[4][12]=312;rate[5][12]=67;	rate[6][12]=0.2;rate[7][12]=56;	rate[8][12]=0.2;rate[9][12]=515;	rate[10][12]=885;	rate[11][12]=106;
			rate[0][13]=13;	rate[1][13]=5;	rate[2][13]=20;	rate[3][13]=0.2;rate[4][13]=184;rate[5][13]=0.2;rate[6][13]=0.2;rate[7][13]=1;	rate[8][13]=14;	rate[9][13]=118;	rate[10][13]=263;	rate[11][13]=11;	rate[12][13]=322;
			rate[0][14]=49;	rate[1][14]=0.2;rate[2][14]=17;	rate[3][14]=0.2;rate[4][14]=0.2;rate[5][14]=39;	rate[6][14]=8;	rate[7][14]=0.2;rate[8][14]=1;	rate[9][14]=0.2;	rate[10][14]=12;	rate[11][14]=17;	rate[12][14]=5;		rate[13][14]=15;
			rate[0][15]=673;rate[1][15]=3;	rate[2][15]=398;rate[3][15]=44;	rate[4][15]=664;rate[5][15]=52;	rate[6][15]=31;	rate[7][15]=226;rate[8][15]=11;	rate[9][15]=7;		rate[10][15]=8;		rate[11][15]=144;	rate[12][15]=112;	rate[13][15]=36;	rate[14][15]=87;
			rate[0][16]=244;rate[1][16]=0.2;rate[2][16]=166;rate[3][16]=0.2;rate[4][16]=183;rate[5][16]=44;	rate[6][16]=43;	rate[7][16]=0.2;rate[8][16]=19;	rate[9][16]=204;	rate[10][16]=48;	rate[11][16]=70;	rate[12][16]=289;	rate[13][16]=14;	rate[14][16]=47;	rate[15][16]=660;
			rate[0][17]=0.2;rate[1][17]=0.2;rate[2][17]=8;	rate[3][17]=0.2;rate[4][17]=22;	rate[5][17]=7;	rate[6][17]=11;	rate[7][17]=2;	rate[8][17]=0.2;rate[9][17]=0.2;	rate[10][17]=21;	rate[11][17]=16;	rate[12][17]=71;	rate[13][17]=54;	rate[14][17]=0.2;	rate[15][17]=2;		rate[16][17]=0.2;
			rate[0][18]=1;	rate[1][18]=4;	rate[2][18]=251;rate[3][18]=0.2;rate[4][18]=72;	rate[5][18]=87;	rate[6][18]=8;	rate[7][18]=9;	rate[8][18]=191;rate[9][18]=12;		rate[10][18]=20;	rate[11][18]=117;	rate[12][18]=71;	rate[13][18]=792;	rate[14][18]=18;	rate[15][18]=30;	rate[16][18]=46;	rate[17][18]=38;
			rate[0][19]=340;rate[1][19]=0.2;rate[2][19]=23;	rate[3][19]=0.2;rate[4][19]=350;rate[5][19]=0.2;rate[6][19]=14;	rate[7][19]=3;	rate[8][19]=0.2;rate[9][19]=1855;	rate[10][19]=85;	rate[11][19]=26;	rate[12][19]=281;	rate[13][19]=52;	rate[14][19]=32;	rate[15][19]=61;	rate[16][19]=544;	rate[17][19]=0.2;rate[18][19]=2;
		}
		else if(mod.is("mtrev")) {
			//pal
			f[0]=0.072; f[1]=0.019; f[2]=0.039; f[3]=0.019; f[4]=0.006;
			f[5]=0.025; f[6]=0.024; f[7]=0.056; f[8]=0.028; f[9]=0.088;
			f[10]=0.168; f[11]=0.023; f[12]=0.054; f[13]=0.061; f[14]=0.054;
			f[15]=0.072; f[16]=0.086; f[17]=0.029; f[18]=0.033; f[19]=0.043;
			
			rate[0][1]=1.2199217606346e+01; 	rate[0][2]=1.4182139942122e+01;
			rate[0][3]=9.2985091873208e+00; 	rate[0][4]=3.1542792981957e+01;
			rate[0][5]=1.0025852846688e+00; 	rate[0][6]=5.1418866803338e+00;
			rate[0][7]=6.3531246495131e+01; 	rate[0][8]=7.3137132861715e+00;
			rate[0][9]=5.0782382656186e+01; 	rate[0][10]=1.3399741808481e+01;
			rate[0][11]=4.4021672780560e+00; 	rate[0][12]=7.4673480520104e+01;
			rate[0][13]=3.3513021631978e+00; 	rate[0][14]=2.8582502221773e+01;
			rate[0][15]=2.0413623195312e+02; 	rate[0][16]=2.5301305153906e+02;
			rate[0][17]=1.0000000000000e+00; 	rate[0][18]=3.4084158197615e+00;
			rate[0][19]=1.0266468401249e+02;

			rate[1][2]=6.9661274444534e+00; 	rate[1][3]=1.0000000000000e+00;
			rate[1][4]=5.4384584796568e+01; 	rate[1][5]=1.1631134513343e+02;
			rate[1][6]=1.0000000000000e+00; 	rate[1][7]=1.2122831341194e+01;
			rate[1][8]=8.6961067087353e+01; 	rate[1][9]=1.0000000000000e+00;
			rate[1][10]=8.1976829394538e+00; 	rate[1][11]=7.4423215395318e+01;
			rate[1][12]=1.0000000000000e+00; 	rate[1][13]=2.4659158338099e+00;
			rate[1][14]=1.2439947713615e+01; 	rate[1][15]=3.1791814866372e+00;
			rate[1][16]=1.0935327216119e+00; 	rate[1][17]=1.1550775790126e+01;
			rate[1][18]=1.0000000000000e+00; 	rate[1][19]=4.0211417480338e+00;

			rate[2][3]=4.1809325468160e+02; 	rate[2][4]=3.1020979842967e+01;
			rate[2][5]=9.1349622725361e+01; 	rate[2][6]=3.3185663516310e+01;
			rate[2][7]=2.8052324651124e+01; 	rate[2][8]=2.6112087577885e+02;
			rate[2][9]=1.4261453863336e+01; 	rate[2][10]=7.9775653461977e+00;
			rate[2][11]=3.2036829276162e+02; 	rate[2][12]=3.4424354918739e+01;
			rate[2][13]=7.9996445145608e+00; 	rate[2][14]=3.8586541461044e+01;
			rate[2][15]=2.6020426225852e+02; 	rate[2][16]=1.2550758780474e+02;
			rate[2][17]=5.6207759736659e+00; 	rate[2][18]=1.0071406219571e+02;
			rate[2][19]=1.0000000000000e+00;

			rate[3][4]=1.0000000000000e+00; 	rate[3][5]=2.9097352675564e+01;
			rate[3][6]=3.0713149855302e+02; 	rate[3][7]=2.9877072751897e+01;
			rate[3][8]=5.9995408885817e+01; 	rate[3][9]=2.2827096245105e+00;
			rate[3][10]=1.0000000000000e+00; 	rate[3][11]=1.2183938185384e+00;
			rate[3][12]=1.0000000000000e+00; 	rate[3][13]=2.6221929413096e+00;
			rate[3][14]=7.0708004204733e+00; 	rate[3][15]=3.6327934317139e+01;
			rate[3][16]=1.4743408713748e+01; 	rate[3][17]=1.0453246057102e+01;
			rate[3][18]=1.1165627147496e+01; 	rate[3][19]=1.0000000000000e+00;

			rate[4][5]=3.9599394038972e+01; 	rate[4][6]=1.0000000000000e+00;
			rate[4][7]=1.6163581056674e+01; 	rate[4][8]=7.4467985406234e+01;
			rate[4][9]=3.3018175376623e+01; 	rate[4][10]=1.3500725995091e+01;
			rate[4][11]=1.0000000000000e+00; 	rate[4][12]=3.2504095376923e+00;
			rate[4][13]=3.7264767083096e+01; 	rate[4][14]=1.6454136037822e+01;
			rate[4][15]=1.4581783243113e+02; 	rate[4][16]=9.4720031458442e+01;
			rate[4][17]=1.7684087896962e+01; 	rate[4][18]=1.3409157685926e+02;
			rate[4][19]=1.0000000000000e+00;

			rate[5][6]=1.6503249008836e+02; 	rate[5][7]=3.5530760735494e+00;
			rate[5][8]=3.0652523140859e+02; 	rate[5][9]=4.3905393139325e+00;
			rate[5][10]=2.0895470525345e+01; 	rate[5][11]=2.4504076430724e+02;
			rate[5][12]=2.4931300477797e+01; 	rate[5][13]=1.0059428264289e+01;
			rate[5][14]=7.2256314165467e+01; 	rate[5][15]=2.8480937892158e+01;
			rate[5][16]=4.9962974409828e+01; 	rate[5][17]=1.0000000000000e+00;
			rate[5][18]=2.0430790980529e+01; 	rate[5][19]=9.9986289000676e+00;

			rate[6][7]=1.4884496769963e+01; 	rate[6][8]=2.5853576435567e+01;
			rate[6][9]=1.7418201388328e+00; 	rate[6][10]=1.0000000000000e+00;
			rate[6][11]=1.6519126809071e+02; 	rate[6][12]=1.0000000000000e+00;
			rate[6][13]=1.4067850525292e+00; 	rate[6][14]=6.7547121641947e+00;
			rate[6][15]=2.8794794140840e+01; 	rate[6][16]=7.8001372062558e+00;
			rate[6][17]=1.0000000000000e+00; 	rate[6][18]=6.9067239183061e+00;
			rate[6][19]=1.1127702362585e+01;

			rate[7][8]=1.0000000000000e+00; 	rate[7][9]=3.1466649021550e+00;
			rate[7][10]=1.2699794194865e+00; 	rate[7][11]=1.1962111069278e+01;
			rate[7][12]=1.0000000000000e+00; 	rate[7][13]=1.0000000000000e+00;
			rate[7][14]=1.0000000000000e+00; 	rate[7][15]=6.6277950574411e+01;
			rate[7][16]=5.8800079133028e+00; 	rate[7][17]=5.7494182626674e+00;
			rate[7][18]=1.6887657206208e+00; 	rate[7][19]=1.3320553471351e+00;

			rate[8][9]=6.4536986087271e+00; 	rate[8][10]=6.0472584534958e+00;
			rate[8][11]=6.7197196398961e+01; 	rate[8][12]=6.2977633277779e+00;
			rate[8][13]=2.5347805183364e+01; 	rate[8][14]=3.2089868698728e+01;
			rate[8][15]=4.0766987134407e+01; 	rate[8][16]=2.3570850628539e+01;
			rate[8][17]=3.7286635325194e+00; 	rate[8][18]=3.5270764890474e+02;
			rate[8][19]=1.0000000000000e+00;

			rate[9][10]=1.7320653206333e+02; 	rate[9][11]=1.0298655619743e+01;
			rate[9][12]=2.7262244199514e+02; 	rate[9][13]=4.4561065036310e+01;
			rate[9][14]=1.0856482766156e+01; 	rate[9][15]=2.5107659603898e+01;
			rate[9][16]=1.9391167162525e+02; 	rate[9][17]=1.0000000000000e+00;
			rate[9][18]=1.3161329199391e+01; 	rate[9][19]=6.4365086389428e+02;

			rate[10][11]=7.8314019154706e+00; 	rate[10][12]=2.8290920517725e+02;
			rate[10][13]=1.1371735519833e+02; 	rate[10][14]=2.1105885757279e+01;
			rate[10][15]=3.8741359395934e+01; 	rate[10][16]=6.6524559321657e+01;
			rate[10][17]=1.7071378554833e+01; 	rate[10][18]=2.3234516108847e+01;
			rate[10][19]=4.8247261078055e+01;

			rate[11][12]=4.8092094826036e+01; 	rate[11][13]=3.3887559483420e+00;
			rate[11][14]=2.6368577564199e+01; 	rate[11][15]=5.5679895711418e+01;
			rate[11][16]=7.1750284708933e+01; 	rate[11][17]=1.2631893872825e+01;
			rate[11][18]=2.6932728996777e+01; 	rate[11][19]=1.0000000000000e+00;

			rate[12][13]=4.7798798034572e+01; 	rate[12][14]=9.9165053447429e+00;
			rate[12][15]=5.8505442466161e+01; 	rate[12][16]=2.7798190504760e+02;
			rate[12][17]=1.1427000119701e+01; 	rate[12][18]=2.1029990530586e+01;
			rate[12][19]=2.0397078683768e+02;

			rate[13][14]=9.1089574817139e+00; 	rate[13][15]=3.3835737720574e+01;
			rate[13][16]=1.7815549567056e+01; 	rate[13][17]=4.1272404968214e+00;
			rate[13][18]=2.4504156395152e+02; 	rate[13][19]=3.3435675442163e+00;

			rate[14][15]=8.9421193040709e+01; 	rate[14][16]=6.7485067008375e+01;
			rate[14][17]=2.2161693733113e+00; 	rate[14][18]=8.5338209390745e+00;
			rate[14][19]=4.3342126659660e+00;

			rate[15][16]=3.1432036618746e+02; 	rate[15][17]=2.0305343047059e+01;
			rate[15][18]=3.4167877957799e+01; 	rate[15][19]=1.0000000000000e+00;

			rate[16][17]=5.2559565123081e+00; 	rate[16][18]=2.0382362288681e+01;
			rate[16][19]=1.0765527137500e+02;

			rate[17][18]=1.3814733274637e+01; 	rate[17][19]=2.8259139240676e+00;

			rate[18][19]=1.0000000000000e+00;
		}
		
		mod.setAaFreqs(f);
		mod.setSubRates(rate);
	}
}
